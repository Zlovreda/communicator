<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ–¥–∞–∫—Ç–æ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫ - –ö–æ–º-–ö–æ–º</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        h1 {
            font-size: 24px;
            margin: 0;
        }

        .app-version {
            font-size: 14px;
            opacity: 0.8;
        }

        .main-content {
            display: flex;
            min-height: 800px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ª–µ–≤–æ–π –ø–∞–Ω–µ–ª–∏ */
        .left-panel {
            width: 300px;
            background: #f8f9fa;
            border-right: 1px solid #dee2e6;
            display: flex;
            flex-direction: column;
        }

        .card-list-container {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
        }

        .card-search {
            padding: 15px;
            border-bottom: 1px solid #dee2e6;
        }

        .card-search input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .filters {
            padding: 15px;
            border-bottom: 1px solid #dee2e6;
        }

        .filter-group {
            margin-bottom: 15px;
        }

        .filter-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #2c3e50;
            font-size: 14px;
        }

        .filter-group select {
            width: 100%;
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .card-list {
            list-style: none;
        }

        .card-list-item {
            padding: 12px 15px;
            border: 1px solid #dee2e6;
            margin-bottom: 8px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-list-item:hover {
            border-color: #3498db;
            background: #e3f2fd;
        }

        .card-list-item.selected {
            border-color: #3498db;
            background: #bbdefb;
        }

        .card-list-item .card-emoji {
            font-size: 20px;
        }

        .card-list-item .card-text {
            flex: 1;
            font-size: 14px;
            font-weight: 500;
        }

        .card-list-item .card-id {
            font-size: 11px;
            color: #666;
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 3px;
        }

        .card-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–∏ */
        .right-panel {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .toolbar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #dee2e6;
        }

        .button-group {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-success:hover {
            background: #219653;
        }

        .btn-warning {
            background: #f39c12;
            color: white;
        }

        .btn-warning:hover {
            background: #e67e22;
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        .status-bar {
            display: flex;
            gap: 10px;
            align-items: center;
            font-size: 14px;
            color: #666;
        }

        /* –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è */
        .editor-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .form-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }

        .form-section h3 {
            margin-bottom: 15px;
            color: #2c3e50;
            font-size: 16px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #34495e;
            font-size: 14px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 5px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
        }

        /* –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä */
        .metadata-editor {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 15px;
        }

        .metadata-section {
            margin-bottom: 20px;
        }

        .metadata-section h4 {
            margin-bottom: 10px;
            color: #2c3e50;
            font-size: 14px;
        }

        .metadata-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }

        .metadata-btn {
            padding: 6px 12px;
            background: #e3f2fd;
            border: 1px solid #3498db;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }

        .metadata-btn:hover {
            background: #bbdefb;
        }

        .metadata-btn.active {
            background: #3498db;
            color: white;
        }

        .allowed-objects-editor {
            margin-top: 15px;
        }

        .search-container {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .search-container input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .objects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            max-height: 200px;
            overflow-y: auto;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
            border: 1px solid #dee2e6;
        }

        .object-item {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
            font-size: 13px;
        }

        .object-item:hover {
            border-color: #3498db;
            background: #e3f2fd;
        }

        .object-item.selected {
            border-color: #3498db;
            background: #bbdefb;
            font-weight: bold;
        }

        .object-item .emoji {
            font-size: 20px;
            display: block;
            margin-bottom: 5px;
        }

        /* –§–æ—Ä–º—ã —Å–ª–æ–≤ */
        .word-forms-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
        }

        .word-form-item {
            margin-bottom: 10px;
        }

        .word-form-item label {
            display: block;
            font-size: 12px;
            color: #666;
            margin-bottom: 3px;
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .modal-header {
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            margin: 0;
            color: #2c3e50;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            padding: 15px 20px;
            background: #f8f9fa;
            border-top: 1px solid #dee2e6;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #666;
        }

        /* –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ */
        .sort-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
        }

        .sort-btn {
            padding: 6px 12px;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
        }

        .sort-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }

        /* –í–∞–ª–∏–¥–∞—Ü–∏—è */
        .validation-results {
            background: #fff3e0;
            border: 1px solid #ff9800;
            border-radius: 6px;
            padding: 15px;
            margin-top: 20px;
        }

        .validation-results h4 {
            color: #ef6c00;
            margin-bottom: 10px;
        }

        .validation-item {
            padding: 8px;
            border-bottom: 1px solid #ffe0b2;
            font-size: 14px;
        }

        .validation-item.error {
            color: #d32f2f;
        }

        .validation-item.warning {
            color: #ff9800;
        }

        .validation-item.success {
            color: #388e3c;
        }

        /* –ú–∞—Å—Å–æ–≤–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ */
        .bulk-edit {
            background: #e8f5e9;
            border: 1px solid #4caf50;
            border-radius: 6px;
            padding: 15px;
            margin-top: 20px;
        }

        .bulk-edit h4 {
            color: #2e7d32;
            margin-bottom: 10px;
        }

        /* JSON —Ä–µ–¥–∞–∫—Ç–æ—Ä */
        .json-editor {
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.4;
            tab-size: 2;
            white-space: pre-wrap;
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 6px;
            max-height: 300px;
            overflow-y: auto;
        }

        .json-key { color: #3498db; }
        .json-string { color: #2ecc71; }
        .json-number { color: #e74c3c; }
        .json-boolean { color: #9b59b6; }
        .json-null { color: #95a5a6; }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 1024px) {
            .main-content {
                flex-direction: column;
            }
            
            .left-panel {
                width: 100%;
                max-height: 400px;
            }
        }

        @media (max-width: 768px) {
            .editor-form {
                grid-template-columns: 1fr;
            }
            
            .toolbar {
                flex-direction: column;
                gap: 10px;
            }
            
            .button-group {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div>
                <h1>–†–µ–¥–∞–∫—Ç–æ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫ - –ö–æ–º-–ö–æ–º</h1>
                <div class="app-version">–í–µ—Ä—Å–∏—è 2.0</div>
            </div>
            <div class="status-bar">
                <span id="cardCount">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                <span id="selectedCount">0 –≤—ã–±—Ä–∞–Ω–æ</span>
            </div>
        </header>

        <div class="main-content">
            <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
            <div class="left-panel">
                <div class="card-search">
                    <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, ID –∏–ª–∏ —Ç–µ–≥–∞–º...">
                </div>
                
                <div class="filters">
                    <div class="filter-group">
                        <label>–¢–∏–ø –∫–∞—Ä—Ç–æ—á–∫–∏:</label>
                        <select id="typeFilter">
                            <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
                            <option value="category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</option>
                            <option value="action">–î–µ–π—Å—Ç–≤–∏–µ</option>
                            <option value="object">–û–±—ä–µ–∫—Ç</option>
                            <option value="person">–ß–µ–ª–æ–≤–µ–∫</option>
                            <option value="place">–ú–µ—Å—Ç–æ</option>
                            <option value="emotion">–≠–º–æ—Ü–∏—è</option>
                            <option value="pain">–ë–æ–ª—å</option>
                            <option value="time">–í—Ä–µ–º—è</option>
                            <option value="dialog">–î–∏–∞–ª–æ–≥</option>
                            <option value="learning">–û–±—É—á–µ–Ω–∏–µ</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:</label>
                        <select id="sortSelect">
                            <option value="text">–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é (–ê-–Ø)</option>
                            <option value="text-desc">–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é (–Ø-–ê)</option>
                            <option value="id">–ü–æ ID</option>
                            <option value="type">–ü–æ —Ç–∏–ø—É</option>
                            <option value="usageCount">–ü–æ —á–∞—Å—Ç–æ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</option>
                            <option value="created">–ü–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è</option>
                        </select>
                    </div>
                </div>
                
                <div class="card-list-container">
                    <div class="sort-controls">
                        <button class="sort-btn" data-sort="text">–ê-–Ø</button>
                        <button class="sort-btn" data-sort="type">–¢–∏–ø</button>
                        <button class="sort-btn" data-sort="usageCount">–ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å</button>
                    </div>
                    
                    <ul class="card-list" id="cardList">
                        <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                    </ul>
                </div>
            </div>

            <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å -->
            <div class="right-panel">
                <div class="toolbar">
                    <div class="button-group">
                        <button class="btn btn-primary" id="addCardBtn">+ –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É</button>
                        <button class="btn btn-success" id="saveCardBtn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                        <button class="btn btn-warning" id="duplicateBtn">‚éò –î—É–±–ª–∏—Ä–æ–≤–∞—Ç—å</button>
                        <button class="btn btn-danger" id="deleteCardBtn">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                    
                    <div class="button-group">
                        <button class="btn btn-secondary" id="importBtn">üì• –ò–º–ø–æ—Ä—Ç</button>
                        <button class="btn btn-secondary" id="exportBtn">üì§ –≠–∫—Å–ø–æ—Ä—Ç</button>
                        <button class="btn btn-secondary" id="loadFromServerBtn">üåê –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–∞</button>
                        <button class="btn btn-secondary" id="validateBtn">‚úì –ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                    </div>
                </div>

                <!-- –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
                <div class="editor-form" id="editorForm">
                    <div class="form-section">
                        <h3>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                        
                        <div class="form-group">
                            <label for="cardId">ID –∫–∞—Ä—Ç–æ—á–∫–∏:</label>
                            <input type="text" id="cardId" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: CAT-GAMES" required>
                            <small>–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä. –§–æ—Ä–º–∞—Ç: –¢–ò–ü-–ù–ê–ó–í–ê–ù–ò–ï</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="cardText">–¢–µ–∫—Å—Ç (–æ—Å–Ω–æ–≤–Ω–∞—è —Ñ–æ—Ä–º–∞):</label>
                            <input type="text" id="cardText" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –∏–≥—Ä–∞—Ç—å" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="cardEmoji">–≠–º–æ–¥–∑–∏:</label>
                            <input type="text" id="cardEmoji" placeholder="üéÆ" maxlength="3">
                        </div>
                        
                        <div class="form-group">
                            <label for="cardType">–¢–∏–ø –∫–∞—Ä—Ç–æ—á–∫–∏:</label>
                            <select id="cardType">
                                <option value="category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</option>
                                <option value="action">–î–µ–π—Å—Ç–≤–∏–µ</option>
                                <option value="object">–û–±—ä–µ–∫—Ç</option>
                                <option value="person">–ß–µ–ª–æ–≤–µ–∫</option>
                                <option value="place">–ú–µ—Å—Ç–æ</option>
                                <option value="emotion">–≠–º–æ—Ü–∏—è</option>
                                <option value="pain">–ë–æ–ª—å</option>
                                <option value="time">–í—Ä–µ–º—è</option>
                                <option value="dialog">–î–∏–∞–ª–æ–≥</option>
                                <option value="learning">–û–±—É—á–µ–Ω–∏–µ</option>
                                <option value="color">–¶–≤–µ—Ç</option>
                                <option value="help">–ü–æ–º–æ—â—å</option>
                                <option value="request">–ó–∞–ø—Ä–æ—Å</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="cardCategory">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
                            <select id="cardCategory">
                                <option value="">–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                                <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </select>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>–í–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</h3>
                        
                        <div class="form-group">
                            <label for="cardColor">–¶–≤–µ—Ç —Ñ–æ–Ω–∞:</label>
                            <input type="color" id="cardColor" value="#E3F2FD">
                        </div>
                        
                        <div class="form-group">
                            <label for="borderColor">–¶–≤–µ—Ç —Ä–∞–º–∫–∏:</label>
                            <input type="color" id="borderColor" value="#2196F3">
                        </div>
                        
                        <div class="form-group">
                            <label>–°–µ–∫—Ü–∏–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:</label>
                            <div class="checkbox-group" id="sectionsCheckbox">
                                <!-- –°–µ–∫—Ü–∏–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>–ì—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–æ—Ä–º—ã</h3>
                        
                        <div class="word-forms-grid">
                            <div class="word-form-item">
                                <label for="formAccusative">–í–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–π (–∫–æ–≥–æ? —á—Ç–æ?)</label>
                                <input type="text" id="formAccusative" placeholder="—è–±–ª–æ–∫–æ">
                            </div>
                            
                            <div class="word-form-item">
                                <label for="formGenitive">–†–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π (–∫–æ–≥–æ? —á–µ–≥–æ?)</label>
                                <input type="text" id="formGenitive" placeholder="—è–±–ª–æ–∫–∞">
                            </div>
                            
                            <div class="word-form-item">
                                <label for="formDative">–î–∞—Ç–µ–ª—å–Ω—ã–π (–∫–æ–º—É? —á–µ–º—É?)</label>
                                <input type="text" id="formDative" placeholder="—è–±–ª–æ–∫—É">
                            </div>
                            
                            <div class="word-form-item">
                                <label for="formInstrumental">–¢–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–π (–∫–µ–º? —á–µ–º?)</label>
                                <input type="text" id="formInstrumental" placeholder="—è–±–ª–æ–∫–æ–º">
                            </div>
                            
                            <div class="word-form-item">
                                <label for="formPrepositional">–ü—Ä–µ–¥–ª–æ–∂–Ω—ã–π (–æ –∫–æ–º? –æ —á–µ–º?)</label>
                                <input type="text" id="formPrepositional" placeholder="—è–±–ª–æ–∫–µ">
                            </div>
                            
                            <div class="word-form-item">
                                <label for="formWith">–° –ø—Ä–µ–¥–ª–æ–≥–æ–º "—Å"</label>
                                <input type="text" id="formWith" placeholder="—Å —è–±–ª–æ–∫–æ–º">
                            </div>
                            
                            <div class="word-form-item">
                                <label for="formIn">–° –ø—Ä–µ–¥–ª–æ–≥–æ–º "–≤"</label>
                                <input type="text" id="formIn" placeholder="–≤ —è–±–ª–æ–∫–æ">
                            </div>
                            
                            <div class="word-form-item">
                                <label for="formOn">–° –ø—Ä–µ–¥–ª–æ–≥–æ–º "–Ω–∞"</label>
                                <input type="text" id="formOn" placeholder="–Ω–∞ —è–±–ª–æ–∫–µ">
                            </div>
                        </div>
                    </div>

                    <div class="form-section" style="grid-column: 1 / -1;">
                        <h3>–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (JSON)</h3>
                        
                        <div class="metadata-editor">
                            <div class="metadata-section">
                                <h4>–†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:</h4>
                                <div class="metadata-controls">
                                    <button class="metadata-btn" data-field="allowedWith" data-value="people">–õ—é–¥–∏</button>
                                    <button class="metadata-btn" data-field="allowedWith" data-value="pets">–ü–∏—Ç–æ–º—Ü—ã</button>
                                    <button class="metadata-btn" data-field="allowedWith" data-value="places">–ú–µ—Å—Ç–∞</button>
                                    <button class="metadata-btn" data-field="allowedWith" data-value="objects">–û–±—ä–µ–∫—Ç—ã</button>
                                    <button class="metadata-btn" data-field="allowedWith" data-value="time">–í—Ä–µ–º—è</button>
                                </div>
                            </div>
                            
                            <div class="metadata-section">
                                <h4>–õ–∏–º–∏—Ç—ã:</h4>
                                <div class="metadata-controls">
                                    <div class="form-group">
                                        <label for="maxPeople">–ú–∞–∫—Å. –ª—é–¥–µ–π:</label>
                                        <input type="number" id="maxPeople" min="0" value="0" style="width: 80px;">
                                    </div>
                                    <div class="form-group">
                                        <label for="maxPets">–ú–∞–∫—Å. –ø–∏—Ç–æ–º—Ü–µ–≤:</label>
                                        <input type="number" id="maxPets" min="0" value="0" style="width: 80px;">
                                    </div>
                                    <div class="form-group">
                                        <label for="maxPlaces">–ú–∞–∫—Å. –º–µ—Å—Ç:</label>
                                        <input type="number" id="maxPlaces" min="0" value="0" style="width: 80px;">
                                    </div>
                                    <div class="form-group">
                                        <label for="maxObjects">–ú–∞–∫—Å. –æ–±—ä–µ–∫—Ç–æ–≤:</label>
                                        <input type="number" id="maxObjects" min="0" value="0" style="width: 80px;">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="metadata-section">
                                <h4>–†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã:</h4>
                                <div class="allowed-objects-editor">
                                    <div class="search-container">
                                        <input type="text" id="objectSearch" placeholder="–ü–æ–∏—Å–∫ –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ —Ç–µ–≥–∞–º...">
                                        <button class="btn btn-secondary" id="clearObjectsBtn">–û—á–∏—Å—Ç–∏—Ç—å</button>
                                    </div>
                                    
                                    <div class="objects-grid" id="objectsGrid">
                                        <!-- –û–±—ä–µ–∫—Ç—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                    </div>
                                    
                                    <div id="selectedObjects" style="margin-top: 10px; font-size: 12px; color: #666;">
                                        –í—ã–±—Ä–∞–Ω–æ: <span id="selectedObjectsCount">0</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="metadata-section">
                                <h4>JSON —Ä–µ–¥–∞–∫—Ç–æ—Ä:</h4>
                                <div class="json-editor" id="jsonEditor" contenteditable="true">
                                    {
  "allowedWith": [],
  "allowedObjects": [],
  "maxPeople": 0,
  "maxPets": 0,
  "maxPlaces": 0,
  "maxObjects": 0
}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                        
                        <div class="form-group">
                            <label for="cardTags">–¢–µ–≥–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):</label>
                            <input type="text" id="cardTags" placeholder="–∏–≥—Ä–∞, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –≤–µ—Å–µ–ª—å–µ">
                        </div>
                        
                        <div class="form-group">
                            <label for="difficulty">–°–ª–æ–∂–Ω–æ—Å—Ç—å:</label>
                            <select id="difficulty">
                                <option value="1">–û—á–µ–Ω—å –ª–µ–≥–∫–æ</option>
                                <option value="2">–õ–µ–≥–∫–æ</option>
                                <option value="3">–°—Ä–µ–¥–Ω–µ</option>
                                <option value="4">–°–ª–æ–∂–Ω–æ</option>
                                <option value="5">–û—á–µ–Ω—å —Å–ª–æ–∂–Ω–æ</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="status">–°—Ç–∞—Ç—É—Å:</label>
                            <select id="status">
                                <option value="active">–ê–∫—Ç–∏–≤–Ω–∞</option>
                                <option value="disabled">–û—Ç–∫–ª—é—á–µ–Ω–∞</option>
                                <option value="hidden">–°–∫—Ä—ã—Ç–∞</option>
                                <option value="draft">–ß–µ—Ä–Ω–æ–≤–∏–∫</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="usageCount">–°—á–µ—Ç—á–∏–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:</label>
                            <input type="number" id="usageCount" min="0" value="0">
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>–°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                        
                        <div class="form-group">
                            <label>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:</label>
                            <input type="text" id="createdDate" disabled style="background: #f0f0f0;">
                        </div>
                        
                        <div class="form-group">
                            <label>–î–∞—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è:</label>
                            <input type="text" id="modifiedDate" disabled style="background: #f0f0f0;">
                        </div>
                        
                        <div class="form-group">
                            <label for="author">–ê–≤—Ç–æ—Ä:</label>
                            <select id="author">
                                <option value="system">–°–∏—Å—Ç–µ–º–∞</option>
                                <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
                                <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="version">–í–µ—Ä—Å–∏—è:</label>
                            <input type="number" id="version" min="1" value="1">
                        </div>
                        
                        <div class="form-group">
                            <label for="description">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                            <textarea id="description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏..."></textarea>
                        </div>
                    </div>
                </div>

                <!-- –ú–∞—Å—Å–æ–≤–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ -->
                <div class="bulk-edit" id="bulkEditSection" style="display: none;">
                    <h4>–ú–∞—Å—Å–æ–≤–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (<span id="bulkCount">0</span> –∫–∞—Ä—Ç–æ—á–µ–∫)</h4>
                    <div class="metadata-controls">
                        <button class="btn btn-secondary" id="bulkAddTagBtn">–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥</button>
                        <button class="btn btn-secondary" id="bulkRemoveTagBtn">–£–¥–∞–ª–∏—Ç—å —Ç–µ–≥</button>
                        <button class="btn btn-secondary" id="bulkChangeStatusBtn">–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å</button>
                        <button class="btn btn-secondary" id="bulkChangeCategoryBtn">–ò–∑–º–µ–Ω–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</button>
                        <button class="btn btn-warning" id="applyBulkBtn">–ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                    </div>
                </div>

                <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ -->
                <div class="validation-results" id="validationResults" style="display: none;">
                    <h4>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏</h4>
                    <div id="validationList">
                        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–º–ø–æ—Ä—Ç–∞ -->
    <div class="modal" id="importModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–ò–º–ø–æ—Ä—Ç –∫–∞—Ä—Ç–æ—á–µ–∫</h3>
                <button class="close-btn" id="closeImportModal">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª JSON:</label>
                    <input type="file" id="importFile" accept=".json">
                </div>
                
                <div class="form-group">
                    <label>–ò–ª–∏ –≤—Å—Ç–∞–≤—å—Ç–µ JSON:</label>
                    <textarea id="importJson" placeholder='{"cards": {...}}' rows="10"></textarea>
                </div>
                
                <div class="form-group">
                    <label>–†–µ–∂–∏–º –∏–º–ø–æ—Ä—Ç–∞:</label>
                    <select id="importMode">
                        <option value="merge">–û–±—ä–µ–¥–∏–Ω–∏—Ç—å (—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ)</option>
                        <option value="replace">–ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ</option>
                        <option value="update">–û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ</option>
                        <option value="add">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="validateOnImport" checked> –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ø–µ—Ä–µ–¥ –∏–º–ø–æ—Ä—Ç–æ–º
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelImportBtn">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" id="executeImportBtn">–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ -->
    <div class="modal" id="exportModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–≠–∫—Å–ø–æ—Ä—Ç –∫–∞—Ä—Ç–æ—á–µ–∫</h3>
                <button class="close-btn" id="closeExportModal">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>–ß—Ç–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å:</label>
                    <select id="exportScope">
                        <option value="all">–í—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏</option>
                        <option value="selected">–í—ã–±—Ä–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏</option>
                        <option value="filtered">–û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏</option>
                        <option value="current">–¢–µ–∫—É—â—É—é –∫–∞—Ä—Ç–æ—á–∫—É</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>–í–∫–ª—é—á–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø–æ–ª—è:</label>
                    <div class="checkbox-group">
                        <label class="checkbox-item">
                            <input type="checkbox" id="exportSystemFields" checked> –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="exportUsageCount" checked> –°—á–µ—Ç—á–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
                        </label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>–§–æ—Ä–º–∞—Ç:</label>
                    <select id="exportFormat">
                        <option value="json">JSON (–ø–æ–ª–Ω—ã–π)</option>
                        <option value="json-min">JSON (–º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)</option>
                        <option value="csv">CSV (—Ç–∞–±–ª–∏—Ü–∞)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä:</label>
                    <textarea id="exportPreview" rows="6" readonly style="font-family: monospace;"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelExportBtn">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" id="copyExportBtn">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                <button class="btn btn-success" id="downloadExportBtn">–°–∫–∞—á–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–≥—Ä—É–∑–∫–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞ -->
    <div class="modal" id="serverLoadModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–ó–∞–≥—Ä—É–∑–∫–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞</h3>
                <button class="close-btn" id="closeServerModal">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>URL –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏:</label>
                    <input type="text" id="serverUrl" value="https://raw.githubusercontent.com/Zlovreda/communicator/refs/heads/main/cards.json" style="width: 100%;">
                </div>
                
                <div class="form-group">
                    <label>–†–µ–∂–∏–º –∑–∞–≥—Ä—É–∑–∫–∏:</label>
                    <select id="serverLoadMode">
                        <option value="merge">–û–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å —Ç–µ–∫—É—â–∏–º–∏</option>
                        <option value="replace">–ó–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–µ</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>–°—Ç–∞—Ç—É—Å:</label>
                    <div id="serverStatus">–ì–æ—Ç–æ–≤ –∫ –∑–∞–≥—Ä—É–∑–∫–µ</div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelServerBtn">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" id="executeServerLoadBtn">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const REMOTE_CARDS_URL = 'https://raw.githubusercontent.com/Zlovreda/communicator/refs/heads/main/cards.json';
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let cards = {};
        let currentCardId = null;
        let selectedCards = new Set();
        let currentSort = 'text';
        let allSections = ['–ì–ª–∞–≤–Ω–∞—è', '–û–±—É—á–µ–Ω–∏–µ', '–î–∏–∞–ª–æ–≥', '–≠–º–æ—Ü–∏–∏'];
        let metadata = {
            allowedWith: [],
            allowedObjects: [],
            maxPeople: 0,
            maxPets: 0,
            maxPlaces: 0,
            maxObjects: 0
        };
        
        // –ö–ª–∞—Å—Å —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –∫–∞—Ä—Ç–æ—á–µ–∫
        class CardEditor {
            constructor() {
                this.loadCards();
                this.initEventListeners();
                this.populateFilters();
                this.renderCardList();
                this.updateCounters();
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫ –∏–∑ localStorage
            loadCards() {
                const savedCards = localStorage.getItem('communicatorCards');
                if (savedCards) {
                    try {
                        const parsed = JSON.parse(savedCards);
                        cards = parsed.cards || parsed;
                        console.log('–ö–∞—Ä—Ç–æ—á–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', Object.keys(cards).length);
                    } catch (e) {
                        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ä—Ç–æ—á–µ–∫:', e);
                        cards = {};
                    }
                } else {
                    cards = {};
                    console.log('–ö–∞—Ä—Ç–æ—á–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã, –Ω–∞—á–∏–Ω–∞–µ–º —Å –ø—É—Å—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞');
                }
            }
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –≤ localStorage
            saveCards() {
                const dataToSave = { cards };
                localStorage.setItem('communicatorCards', JSON.stringify(dataToSave));
                this.updateCounters();
                console.log('–ö–∞—Ä—Ç–æ—á–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
            initEventListeners() {
                // –ö–Ω–æ–ø–∫–∏ –ø–∞–Ω–µ–ª–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
                document.getElementById('addCardBtn').addEventListener('click', () => this.addNewCard());
                document.getElementById('saveCardBtn').addEventListener('click', () => this.saveCurrentCard());
                document.getElementById('duplicateBtn').addEventListener('click', () => this.duplicateCard());
                document.getElementById('deleteCardBtn').addEventListener('click', () => this.deleteCard());
                document.getElementById('importBtn').addEventListener('click', () => this.showImportModal());
                document.getElementById('exportBtn').addEventListener('click', () => this.showExportModal());
                document.getElementById('loadFromServerBtn').addEventListener('click', () => this.showServerLoadModal());
                document.getElementById('validateBtn').addEventListener('click', () => this.validateCards());
                
                // –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã
                document.getElementById('searchInput').addEventListener('input', () => this.renderCardList());
                document.getElementById('typeFilter').addEventListener('change', () => this.renderCardList());
                document.getElementById('sortSelect').addEventListener('change', () => {
                    currentSort = document.getElementById('sortSelect').value;
                    this.renderCardList();
                });
                
                // –ö–Ω–æ–ø–∫–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
                document.querySelectorAll('.sort-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const sort = e.target.dataset.sort;
                        document.querySelectorAll('.sort-btn').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        currentSort = sort;
                        this.renderCardList();
                    });
                });
                
                // –†–µ–¥–∞–∫—Ç–æ—Ä –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
                document.querySelectorAll('.metadata-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const field = e.target.dataset.field;
                        const value = e.target.dataset.value;
                        this.toggleMetadataValue(field, value, e.target);
                    });
                });
                
                // –ü–æ–ª—è –ª–∏–º–∏—Ç–æ–≤
                document.getElementById('maxPeople').addEventListener('input', () => this.updateMetadataFromUI());
                document.getElementById('maxPets').addEventListener('input', () => this.updateMetadataFromUI());
                document.getElementById('maxPlaces').addEventListener('input', () => this.updateMetadataFromUI());
                document.getElementById('maxObjects').addEventListener('input', () => this.updateMetadataFromUI());
                
                // –ü–æ–∏—Å–∫ –æ–±—ä–µ–∫—Ç–æ–≤
                document.getElementById('objectSearch').addEventListener('input', () => this.renderObjectsGrid());
                document.getElementById('clearObjectsBtn').addEventListener('click', () => this.clearSelectedObjects());
                
                // JSON —Ä–µ–¥–∞–∫—Ç–æ—Ä
                document.getElementById('jsonEditor').addEventListener('input', () => this.updateMetadataFromJson());
                
                // –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è –∫–∞—Ä—Ç–æ—á–∫–∏
                document.getElementById('cardId').addEventListener('blur', () => this.validateCardId());
                document.getElementById('cardType').addEventListener('change', () => this.onCardTypeChange());
                
                // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
                this.initModalEvents();
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
            initModalEvents() {
                // –ò–º–ø–æ—Ä—Ç
                document.getElementById('closeImportModal').addEventListener('click', () => {
                    document.getElementById('importModal').classList.remove('active');
                });
                document.getElementById('cancelImportBtn').addEventListener('click', () => {
                    document.getElementById('importModal').classList.remove('active');
                });
                document.getElementById('executeImportBtn').addEventListener('click', () => this.executeImport());
                document.getElementById('importFile').addEventListener('change', (e) => this.handleFileImport(e));
                
                // –≠–∫—Å–ø–æ—Ä—Ç
                document.getElementById('closeExportModal').addEventListener('click', () => {
                    document.getElementById('exportModal').classList.remove('active');
                });
                document.getElementById('cancelExportBtn').addEventListener('click', () => {
                    document.getElementById('exportModal').classList.remove('active');
                });
                document.getElementById('copyExportBtn').addEventListener('click', () => this.copyExport());
                document.getElementById('downloadExportBtn').addEventListener('click', () => this.downloadExport());
                document.getElementById('exportScope').addEventListener('change', () => this.updateExportPreview());
                document.getElementById('exportFormat').addEventListener('change', () => this.updateExportPreview());
                
                // –ó–∞–≥—Ä—É–∑–∫–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞
                document.getElementById('closeServerModal').addEventListener('click', () => {
                    document.getElementById('serverLoadModal').classList.remove('active');
                });
                document.getElementById('cancelServerBtn').addEventListener('click', () => {
                    document.getElementById('serverLoadModal').classList.remove('active');
                });
                document.getElementById('executeServerLoadBtn').addEventListener('click', () => this.loadFromServer());
            }
            
            // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
            populateFilters() {
                // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
                const categorySelect = document.getElementById('cardCategory');
                categorySelect.innerHTML = '<option value="">–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>';
                
                Object.values(cards).forEach(card => {
                    if (card.type === 'category') {
                        const option = document.createElement('option');
                        option.value = card.id;
                        option.textContent = `${card.emoji || ''} ${card.text}`;
                        categorySelect.appendChild(option);
                    }
                });
                
                // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–π
                const sectionsContainer = document.getElementById('sectionsCheckbox');
                sectionsContainer.innerHTML = '';
                
                allSections.forEach(section => {
                    const label = document.createElement('label');
                    label.className = 'checkbox-item';
                    label.innerHTML = `
                        <input type="checkbox" value="${section}"> ${section}
                    `;
                    sectionsContainer.appendChild(label);
                });
            }
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å–ø–∏—Å–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫
            renderCardList() {
                const cardList = document.getElementById('cardList');
                const searchTerm = document.getElementById('searchInput').value.toLowerCase();
                const typeFilter = document.getElementById('typeFilter').value;
                
                // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫
                let filteredCards = Object.values(cards);
                
                if (searchTerm) {
                    filteredCards = filteredCards.filter(card => 
                        card.id.toLowerCase().includes(searchTerm) ||
                        card.text.toLowerCase().includes(searchTerm) ||
                        (card.tags && card.tags.some(tag => tag.toLowerCase().includes(searchTerm)))
                    );
                }
                
                if (typeFilter) {
                    filteredCards = filteredCards.filter(card => card.type === typeFilter);
                }
                
                // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
                filteredCards.sort((a, b) => {
                    switch (currentSort) {
                        case 'text':
                            return a.text.localeCompare(b.text);
                        case 'text-desc':
                            return b.text.localeCompare(a.text);
                        case 'id':
                            return a.id.localeCompare(b.id);
                        case 'type':
                            return a.type.localeCompare(b.type);
                        case 'usageCount':
                            return (b.usageCount || 0) - (a.usageCount || 0);
                        case 'created':
                            return new Date(b.created || 0) - new Date(a.created || 0);
                        default:
                            return a.text.localeCompare(b.text);
                    }
                });
                
                // –û—Ç—Ä–∏—Å–æ–≤–∫–∞
                cardList.innerHTML = '';
                
                filteredCards.forEach(card => {
                    const li = document.createElement('li');
                    li.className = `card-list-item ${currentCardId === card.id ? 'selected' : ''}`;
                    li.dataset.id = card.id;
                    
                    li.innerHTML = `
                        <input type="checkbox" class="card-checkbox" ${selectedCards.has(card.id) ? 'checked' : ''}>
                        <div class="card-emoji">${card.emoji || 'üìÑ'}</div>
                        <div class="card-text">${card.text}</div>
                        <div class="card-id">${card.id}</div>
                    `;
                    
                    li.addEventListener('click', (e) => {
                        if (!e.target.classList.contains('card-checkbox')) {
                            this.loadCard(card.id);
                        }
                    });
                    
                    const checkbox = li.querySelector('.card-checkbox');
                    checkbox.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.toggleCardSelection(card.id, checkbox.checked);
                    });
                    
                    cardList.appendChild(li);
                });
                
                this.updateCounters();
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            loadCard(cardId) {
                const card = cards[cardId];
                if (!card) return;
                
                currentCardId = cardId;
                this.renderCardList();
                
                // –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è
                document.getElementById('cardId').value = card.id;
                document.getElementById('cardText').value = card.text || '';
                document.getElementById('cardEmoji').value = card.emoji || '';
                document.getElementById('cardType').value = card.type || 'object';
                document.getElementById('cardCategory').value = card.category || '';
                document.getElementById('cardColor').value = card.color || '#E3F2FD';
                document.getElementById('borderColor').value = card.borderColor || card.color || '#2196F3';
                document.getElementById('cardTags').value = card.tags ? card.tags.join(', ') : '';
                document.getElementById('difficulty').value = card.difficulty || 1;
                document.getElementById('status').value = card.status || 'active';
                document.getElementById('usageCount').value = card.usageCount || 0;
                document.getElementById('author').value = card.author || 'user';
                document.getElementById('version').value = card.version || 1;
                document.getElementById('description').value = card.metadata?.description || '';
                document.getElementById('createdDate').value = card.created || new Date().toISOString();
                document.getElementById('modifiedDate').value = card.modified || new Date().toISOString();
                
                // –°–µ–∫—Ü–∏–∏
                document.querySelectorAll('#sectionsCheckbox input').forEach(checkbox => {
                    checkbox.checked = card.sections?.includes(checkbox.value) || false;
                });
                
                // –§–æ—Ä–º—ã —Å–ª–æ–≤
                const forms = card.forms || {};
                document.getElementById('formAccusative').value = forms.accusative || '';
                document.getElementById('formGenitive').value = forms.genitive || '';
                document.getElementById('formDative').value = forms.dative || '';
                document.getElementById('formInstrumental').value = forms.instrumental || '';
                document.getElementById('formPrepositional').value = forms.prepositional || '';
                document.getElementById('formWith').value = forms.with || '';
                document.getElementById('formIn').value = forms.in || '';
                document.getElementById('formOn').value = forms.on || '';
                
                // –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
                this.loadMetadata(card.metadata || {});
                
                // –ü–æ–∫–∞–∑–∞—Ç—å –º–∞—Å—Å–æ–≤–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ
                this.updateBulkEditSection();
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
            loadMetadata(metadataObj) {
                metadata = {
                    allowedWith: metadataObj.allowedWith || [],
                    allowedObjects: metadataObj.allowedObjects || [],
                    maxPeople: metadataObj.maxPeople || 0,
                    maxPets: metadataObj.maxPets || 0,
                    maxPlaces: metadataObj.maxPlaces || 0,
                    maxObjects: metadataObj.maxObjects || 0
                };
                
                // –ö–Ω–æ–ø–∫–∏ allowedWith
                document.querySelectorAll('.metadata-btn[data-field="allowedWith"]').forEach(btn => {
                    const value = btn.dataset.value;
                    btn.classList.toggle('active', metadata.allowedWith.includes(value));
                });
                
                // –ü–æ–ª—è –ª–∏–º–∏—Ç–æ–≤
                document.getElementById('maxPeople').value = metadata.maxPeople;
                document.getElementById('maxPets').value = metadata.maxPets;
                document.getElementById('maxPlaces').value = metadata.maxPlaces;
                document.getElementById('maxObjects').value = metadata.maxObjects;
                
                // –û–±–Ω–æ–≤–∏—Ç—å JSON —Ä–µ–¥–∞–∫—Ç–æ—Ä
                this.updateJsonEditor();
                
                // –û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ç–∫—É –æ–±—ä–µ–∫—Ç–æ–≤
                this.renderObjectsGrid();
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ JSON —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
            updateJsonEditor() {
                const jsonEditor = document.getElementById('jsonEditor');
                const jsonString = JSON.stringify(metadata, null, 2);
                jsonEditor.textContent = jsonString;
                this.highlightJson(jsonEditor);
            }
            
            // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ JSON
            highlightJson(element) {
                const text = element.textContent;
                let highlighted = text
                    .replace(/("[\w]+"):/g, '<span class="json-key">$1</span>:')
                    .replace(/: ("[^"]*")/g, ': <span class="json-string">$1</span>')
                    .replace(/: ([\d\.]+)/g, ': <span class="json-number">$1</span>')
                    .replace(/: (true|false)/g, ': <span class="json-boolean">$1</span>')
                    .replace(/: null/g, ': <span class="json-null">null</span>');
                
                element.innerHTML = highlighted;
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏–∑ UI
            updateMetadataFromUI() {
                // –û–±–Ω–æ–≤–∏—Ç—å allowedWith –∏–∑ –∫–Ω–æ–ø–æ–∫
                metadata.allowedWith = [];
                document.querySelectorAll('.metadata-btn[data-field="allowedWith"].active').forEach(btn => {
                    metadata.allowedWith.push(btn.dataset.value);
                });
                
                // –û–±–Ω–æ–≤–∏—Ç—å –ª–∏–º–∏—Ç—ã
                metadata.maxPeople = parseInt(document.getElementById('maxPeople').value) || 0;
                metadata.maxPets = parseInt(document.getElementById('maxPets').value) || 0;
                metadata.maxPlaces = parseInt(document.getElementById('maxPlaces').value) || 0;
                metadata.maxObjects = parseInt(document.getElementById('maxObjects').value) || 0;
                
                // –û–±–Ω–æ–≤–∏—Ç—å JSON
                this.updateJsonEditor();
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏–∑ JSON —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
            updateMetadataFromJson() {
                try {
                    const jsonText = document.getElementById('jsonEditor').textContent;
                    const newMetadata = JSON.parse(jsonText);
                    metadata = newMetadata;
                    
                    // –û–±–Ω–æ–≤–∏—Ç—å UI
                    document.querySelectorAll('.metadata-btn[data-field="allowedWith"]').forEach(btn => {
                        const value = btn.dataset.value;
                        btn.classList.toggle('active', metadata.allowedWith.includes(value));
                    });
                    
                    document.getElementById('maxPeople').value = metadata.maxPeople || 0;
                    document.getElementById('maxPets').value = metadata.maxPets || 0;
                    document.getElementById('maxPlaces').value = metadata.maxPlaces || 0;
                    document.getElementById('maxObjects').value = metadata.maxObjects || 0;
                    
                    this.renderObjectsGrid();
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON:', e);
                }
            }
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
            toggleMetadataValue(field, value, button) {
                if (field === 'allowedWith') {
                    const index = metadata.allowedWith.indexOf(value);
                    if (index === -1) {
                        metadata.allowedWith.push(value);
                        button.classList.add('active');
                    } else {
                        metadata.allowedWith.splice(index, 1);
                        button.classList.remove('active');
                    }
                    this.updateJsonEditor();
                }
            }
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å–µ—Ç–∫–∏ –æ–±—ä–µ–∫—Ç–æ–≤
            renderObjectsGrid() {
                const searchTerm = document.getElementById('objectSearch').value.toLowerCase();
                const objectsGrid = document.getElementById('objectsGrid');
                
                // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã
                let objectCards = Object.values(cards).filter(card => 
                    card.type === 'object' || card.type === 'clothing' || card.type === 'book' || card.type === 'creative'
                );
                
                // –ü–æ–∏—Å–∫
                if (searchTerm) {
                    objectCards = objectCards.filter(card => 
                        card.text.toLowerCase().includes(searchTerm) ||
                        card.id.toLowerCase().includes(searchTerm) ||
                        (card.tags && card.tags.some(tag => tag.toLowerCase().includes(searchTerm)))
                    );
                }
                
                // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
                objectCards.sort((a, b) => a.text.localeCompare(b.text));
                
                // –û—Ç—Ä–∏—Å–æ–≤–∫–∞
                objectsGrid.innerHTML = '';
                
                objectCards.forEach(card => {
                    const isSelected = metadata.allowedObjects.includes(card.id);
                    const div = document.createElement('div');
                    div.className = `object-item ${isSelected ? 'selected' : ''}`;
                    div.dataset.id = card.id;
                    div.innerHTML = `
                        <div class="emoji">${card.emoji || 'üì¶'}</div>
                        ${card.text}
                    `;
                    
                    div.addEventListener('click', () => {
                        this.toggleAllowedObject(card.id);
                    });
                    
                    objectsGrid.appendChild(div);
                });
                
                // –û–±–Ω–æ–≤–∏—Ç—å —Å—á–µ—Ç—á–∏–∫
                document.getElementById('selectedObjectsCount').textContent = metadata.allowedObjects.length;
            }
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –≤ allowedObjects
            toggleAllowedObject(cardId) {
                const index = metadata.allowedObjects.indexOf(cardId);
                if (index === -1) {
                    metadata.allowedObjects.push(cardId);
                } else {
                    metadata.allowedObjects.splice(index, 1);
                }
                
                this.updateJsonEditor();
                this.renderObjectsGrid();
            }
            
            // –û—á–∏—Å—Ç–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã
            clearSelectedObjects() {
                metadata.allowedObjects = [];
                this.updateJsonEditor();
                this.renderObjectsGrid();
            }
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏
            addNewCard() {
                const cardId = prompt('–í–≤–µ–¥–∏—Ç–µ ID –Ω–æ–≤–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: NEW-CARD):');
                if (!cardId) return;
                
                if (cards[cardId]) {
                    alert('–ö–∞—Ä—Ç–æ—á–∫–∞ —Å —Ç–∞–∫–∏–º ID —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!');
                    return;
                }
                
                // –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–∞—Ä—Ç–æ—á–∫—É
                const newCard = {
                    id: cardId,
                    text: '–ù–æ–≤–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞',
                    emoji: 'üìù',
                    type: 'object',
                    category: '',
                    forms: {},
                    tags: ['–Ω–æ–≤–∞—è'],
                    difficulty: 1,
                    status: 'draft',
                    usageCount: 0,
                    created: new Date().toISOString(),
                    modified: new Date().toISOString(),
                    author: 'user',
                    version: 1,
                    color: '#E3F2FD',
                    borderColor: '#2196F3',
                    sections: ['–ì–ª–∞–≤–Ω–∞—è'],
                    metadata: {
                        allowedWith: [],
                        allowedObjects: [],
                        maxPeople: 0,
                        maxPets: 0,
                        maxPlaces: 0,
                        maxObjects: 0,
                        description: ''
                    }
                };
                
                cards[cardId] = newCard;
                this.saveCards();
                this.populateFilters();
                this.loadCard(cardId);
                this.renderCardList();
            }
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∫–∞—Ä—Ç–æ—á–∫–∏
            saveCurrentCard() {
                if (!currentCardId) {
                    alert('–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è!');
                    return;
                }
                
                const card = cards[currentCardId];
                if (!card) return;
                
                // –°–æ–±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º—ã
                card.text = document.getElementById('cardText').value;
                card.emoji = document.getElementById('cardEmoji').value;
                card.type = document.getElementById('cardType').value;
                card.category = document.getElementById('cardCategory').value;
                card.color = document.getElementById('cardColor').value;
                card.borderColor = document.getElementById('borderColor').value;
                
                // –¢–µ–≥–∏
                const tagsText = document.getElementById('cardTags').value;
                card.tags = tagsText.split(',').map(tag => tag.trim()).filter(tag => tag);
                
                card.difficulty = parseInt(document.getElementById('difficulty').value);
                card.status = document.getElementById('status').value;
                card.usageCount = parseInt(document.getElementById('usageCount').value) || 0;
                card.author = document.getElementById('author').value;
                card.version = parseInt(document.getElementById('version').value);
                card.modified = new Date().toISOString();
                
                // –°–µ–∫—Ü–∏–∏
                card.sections = [];
                document.querySelectorAll('#sectionsCheckbox input:checked').forEach(checkbox => {
                    card.sections.push(checkbox.value);
                });
                
                // –§–æ—Ä–º—ã —Å–ª–æ–≤
                card.forms = {
                    accusative: document.getElementById('formAccusative').value || undefined,
                    genitive: document.getElementById('formGenitive').value || undefined,
                    dative: document.getElementById('formDative').value || undefined,
                    instrumental: document.getElementById('formInstrumental').value || undefined,
                    prepositional: document.getElementById('formPrepositional').value || undefined,
                    with: document.getElementById('formWith').value || undefined,
                    in: document.getElementById('formIn').value || undefined,
                    on: document.getElementById('formOn').value || undefined
                };
                
                // –£–¥–∞–ª–∏—Ç—å –ø—É—Å—Ç—ã–µ —Ñ–æ—Ä–º—ã
                Object.keys(card.forms).forEach(key => {
                    if (!card.forms[key]) delete card.forms[key];
                });
                
                // –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
                card.metadata = {
                    ...metadata,
                    description: document.getElementById('description').value || undefined
                };
                
                // –û—á–∏—Å—Ç–∏—Ç—å –ø—É—Å—Ç—ã–µ –ø–æ–ª—è
                if (!card.metadata.description) delete card.metadata.description;
                
                this.saveCards();
                this.renderCardList();
                alert('–ö–∞—Ä—Ç–æ—á–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!');
            }
            
            // –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏
            duplicateCard() {
                if (!currentCardId) {
                    alert('–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É –¥–ª—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è!');
                    return;
                }
                
                const original = cards[currentCardId];
                if (!original) return;
                
                const newId = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π ID –¥–ª—è –¥—É–±–ª–∏–∫–∞—Ç–∞:', original.id + '-COPY');
                if (!newId) return;
                
                if (cards[newId]) {
                    alert('–ö–∞—Ä—Ç–æ—á–∫–∞ —Å —Ç–∞–∫–∏–º ID —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!');
                    return;
                }
                
                // –°–æ–∑–¥–∞—Ç—å –≥–ª—É–±–æ–∫—É—é –∫–æ–ø–∏—é
                const duplicate = JSON.parse(JSON.stringify(original));
                duplicate.id = newId;
                duplicate.text = duplicate.text + ' (–∫–æ–ø–∏—è)';
                duplicate.created = new Date().toISOString();
                duplicate.modified = new Date().toISOString();
                duplicate.usageCount = 0;
                duplicate.version = 1;
                
                cards[newId] = duplicate;
                this.saveCards();
                this.populateFilters();
                this.loadCard(newId);
                this.renderCardList();
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏
            deleteCard() {
                if (selectedCards.size > 0) {
                    // –£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏
                    if (!confirm(`–£–¥–∞–ª–∏—Ç—å ${selectedCards.size} –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫?`)) return;
                    
                    selectedCards.forEach(id => {
                        delete cards[id];
                    });
                    
                    selectedCards.clear();
                    currentCardId = null;
                } else if (currentCardId) {
                    // –£–¥–∞–ª–∏—Ç—å —Ç–µ–∫—É—â—É—é –∫–∞—Ä—Ç–æ—á–∫—É
                    if (!confirm(`–£–¥–∞–ª–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É "${currentCardId}"?`)) return;
                    
                    delete cards[currentCardId];
                    currentCardId = null;
                } else {
                    alert('–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è!');
                    return;
                }
                
                this.saveCards();
                this.populateFilters();
                this.clearForm();
                this.renderCardList();
            }
            
            // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
            clearForm() {
                document.getElementById('editorForm').querySelectorAll('input, select, textarea').forEach(element => {
                    if (element.type !== 'button' && element.type !== 'submit') {
                        if (element.type === 'checkbox') {
                            element.checked = false;
                        } else {
                            element.value = '';
                        }
                    }
                });
                
                // –°–±—Ä–æ—Å–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                document.getElementById('cardColor').value = '#E3F2FD';
                document.getElementById('borderColor').value = '#2196F3';
                document.getElementById('difficulty').value = 1;
                document.getElementById('status').value = 'active';
                document.getElementById('usageCount').value = 0;
                document.getElementById('author').value = 'user';
                document.getElementById('version').value = 1;
                
                // –°–±—Ä–æ—Å–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
                this.loadMetadata({});
                
                // –ü–æ–∫–∞–∑–∞—Ç—å –ø–µ—Ä–≤—É—é —Å–µ–∫—Ü–∏—é –∫–∞–∫ –≤—ã–±—Ä–∞–Ω–Ω—É—é
                document.querySelector('#sectionsCheckbox input[value="–ì–ª–∞–≤–Ω–∞—è"]').checked = true;
            }
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –∫–∞—Ä—Ç–æ—á–∫–∏
            toggleCardSelection(cardId, isSelected) {
                if (isSelected) {
                    selectedCards.add(cardId);
                } else {
                    selectedCards.delete(cardId);
                }
                
                this.updateCounters();
                this.updateBulkEditSection();
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–æ–≤
            updateCounters() {
                document.getElementById('cardCount').textContent = `–í—Å–µ–≥–æ –∫–∞—Ä—Ç–æ—á–µ–∫: ${Object.keys(cards).length}`;
                document.getElementById('selectedCount').textContent = `–í—ã–±—Ä–∞–Ω–æ: ${selectedCards.size}`;
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–∏ –º–∞—Å—Å–æ–≤–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            updateBulkEditSection() {
                const bulkSection = document.getElementById('bulkEditSection');
                const bulkCount = document.getElementById('bulkCount');
                
                if (selectedCards.size > 1) {
                    bulkSection.style.display = 'block';
                    bulkCount.textContent = selectedCards.size;
                } else {
                    bulkSection.style.display = 'none';
                }
            }
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è ID –∫–∞—Ä—Ç–æ—á–∫–∏
            validateCardId() {
                const idInput = document.getElementById('cardId');
                const id = idInput.value.trim();
                
                if (!id) return;
                
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç
                if (!/^[A-Z0-9-]+$/.test(id)) {
                    alert('ID –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞–≥–ª–∞–≤–Ω—ã–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ –¥–µ—Ñ–∏—Å—ã!');
                    idInput.focus();
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å
                if (cards[id] && id !== currentCardId) {
                    alert('–ö–∞—Ä—Ç–æ—á–∫–∞ —Å —Ç–∞–∫–∏–º ID —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!');
                    idInput.focus();
                    return;
                }
                
                // –û–±–Ω–æ–≤–∏—Ç—å ID –µ—Å–ª–∏ –æ–Ω –∏–∑–º–µ–Ω–∏–ª—Å—è
                if (currentCardId && id !== currentCardId) {
                    cards[id] = cards[currentCardId];
                    delete cards[currentCardId];
                    cards[id].id = id;
                    currentCardId = id;
                    this.saveCards();
                    this.renderCardList();
                }
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–∏–ø–∞ –∫–∞—Ä—Ç–æ—á–∫–∏
            onCardTypeChange() {
                const type = document.getElementById('cardType').value;
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å ID –µ—Å–ª–∏ –ø–æ–ª–µ –ø—É—Å—Ç–æ–µ
                const idInput = document.getElementById('cardId');
                if (!idInput.value && currentCardId) {
                    const prefix = type.toUpperCase().substring(0, 3);
                    const random = Math.floor(Math.random() * 1000);
                    const newId = `${prefix}-${random}`;
                    idInput.value = newId;
                }
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–º–ø–æ—Ä—Ç–∞
            showImportModal() {
                document.getElementById('importModal').classList.add('active');
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ —Ñ–∞–π–ª–∞
            handleFileImport(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    document.getElementById('importJson').value = e.target.result;
                };
                reader.readAsText(file);
            }
            
            // –í—ã–ø–æ–ª–Ω–∏—Ç—å –∏–º–ø–æ—Ä—Ç
            async executeImport() {
                const importJson = document.getElementById('importJson').value;
                const importMode = document.getElementById('importMode').value;
                const validateOnImport = document.getElementById('validateOnImport').checked;
                
                if (!importJson) {
                    alert('–í–≤–µ–¥–∏—Ç–µ JSON –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞!');
                    return;
                }
                
                try {
                    const importedData = JSON.parse(importJson);
                    const importedCards = importedData.cards || importedData;
                    
                    // –í–∞–ª–∏–¥–∞—Ü–∏—è –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                    if (validateOnImport) {
                        const validation = this.validateCardSet(importedCards);
                        if (validation.errors.length > 0) {
                            alert(`–ù–∞–π–¥–µ–Ω—ã –æ—à–∏–±–∫–∏:\n${validation.errors.join('\n')}\n\n–ò–º–ø–æ—Ä—Ç –æ—Ç–º–µ–Ω–µ–Ω.`);
                            return;
                        }
                    }
                    
                    // –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
                    switch (importMode) {
                        case 'merge':
                            // –û–±—ä–µ–¥–∏–Ω–∏—Ç—å, —Å–æ—Ö—Ä–∞–Ω—è—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ
                            Object.assign(cards, importedCards);
                            break;
                        case 'replace':
                            // –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ
                            cards = importedCards;
                            break;
                        case 'update':
                            // –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ
                            Object.keys(importedCards).forEach(id => {
                                if (cards[id]) {
                                    cards[id] = importedCards[id];
                                }
                            });
                            break;
                        case 'add':
                            // –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ
                            Object.keys(importedCards).forEach(id => {
                                if (!cards[id]) {
                                    cards[id] = importedCards[id];
                                }
                            });
                            break;
                    }
                    
                    this.saveCards();
                    this.populateFilters();
                    this.renderCardList();
                    
                    document.getElementById('importModal').classList.remove('active');
                    alert(`–ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω! –ó–∞–≥—Ä—É–∂–µ–Ω–æ –∫–∞—Ä—Ç–æ—á–µ–∫: ${Object.keys(importedCards).length}`);
                } catch (e) {
                    alert(`–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞: ${e.message}`);
                }
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∞
            showExportModal() {
                document.getElementById('exportModal').classList.add('active');
                this.updateExportPreview();
            }
            
            // –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —ç–∫—Å–ø–æ—Ä—Ç–∞
            updateExportPreview() {
                const scope = document.getElementById('exportScope').value;
                const format = document.getElementById('exportFormat').value;
                
                let cardsToExport = {};
                
                switch (scope) {
                    case 'all':
                        cardsToExport = cards;
                        break;
                    case 'selected':
                        selectedCards.forEach(id => {
                            if (cards[id]) cardsToExport[id] = cards[id];
                        });
                        break;
                    case 'filtered':
                        // –ó–¥–µ—Å—å –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫
                        // –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤—Å–µ
                        cardsToExport = cards;
                        break;
                    case 'current':
                        if (currentCardId) {
                            cardsToExport[currentCardId] = cards[currentCardId];
                        }
                        break;
                }
                
                // –£–¥–∞–ª–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø–æ–ª—è –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                const exportSystemFields = document.getElementById('exportSystemFields').checked;
                const exportUsageCount = document.getElementById('exportUsageCount').checked;
                
                let exportData = { cards: cardsToExport };
                
                if (!exportSystemFields || !exportUsageCount) {
                    const cleanedCards = {};
                    Object.keys(cardsToExport).forEach(id => {
                        const card = { ...cardsToExport[id] };
                        
                        if (!exportSystemFields) {
                            delete card.created;
                            delete card.modified;
                            delete card.author;
                            delete card.version;
                        }
                        
                        if (!exportUsageCount) {
                            delete card.usageCount;
                        }
                        
                        cleanedCards[id] = card;
                    });
                    
                    exportData = { cards: cleanedCards };
                }
                
                // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
                let previewText = '';
                switch (format) {
                    case 'json':
                        previewText = JSON.stringify(exportData, null, 2);
                        break;
                    case 'json-min':
                        previewText = JSON.stringify(exportData);
                        break;
                    case 'csv':
                        previewText = this.convertToCSV(exportData.cards);
                        break;
                }
                
                document.getElementById('exportPreview').value = previewText;
            }
            
            // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ CSV
            convertToCSV(cardsObj) {
                const cardsArray = Object.values(cardsObj);
                if (cardsArray.length === 0) return '';
                
                // –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø–æ–ª—è
                const allFields = new Set();
                cardsArray.forEach(card => {
                    Object.keys(card).forEach(key => allFields.add(key));
                    if (card.metadata) {
                        Object.keys(card.metadata).forEach(key => allFields.add(`metadata.${key}`));
                    }
                    if (card.forms) {
                        Object.keys(card.forms).forEach(key => allFields.add(`forms.${key}`));
                    }
                });
                
                // –°–æ–∑–¥–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫
                const header = Array.from(allFields).join(',');
                let csv = header + '\n';
                
                // –î–æ–±–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
                cardsArray.forEach(card => {
                    const row = [];
                    allFields.forEach(field => {
                        let value = '';
                        
                        if (field.includes('.')) {
                            const [parent, child] = field.split('.');
                            if (card[parent] && card[parent][child] !== undefined) {
                                value = card[parent][child];
                            }
                        } else {
                            value = card[field];
                        }
                        
                        // –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –º–∞—Å—Å–∏–≤—ã –∏ –æ–±—ä–µ–∫—Ç—ã
                        if (Array.isArray(value)) {
                            value = value.join(';');
                        } else if (typeof value === 'object') {
                            value = JSON.stringify(value);
                        }
                        
                        // –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—è—Ç—ã–µ –∏ –∫–∞–≤—ã—á–∫–∏
                        if (typeof value === 'string' && (value.includes(',') || value.includes('"'))) {
                            value = `"${value.replace(/"/g, '""')}"`;
                        }
                        
                        row.push(value || '');
                    });
                    
                    csv += row.join(',') + '\n';
                });
                
                return csv;
            }
            
            // –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç
            copyExport() {
                const preview = document.getElementById('exportPreview');
                preview.select();
                document.execCommand('copy');
                alert('–î–∞–Ω–Ω—ã–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
            }
            
            // –°–∫–∞—á–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç
            downloadExport() {
                const format = document.getElementById('exportFormat').value;
                const preview = document.getElementById('exportPreview').value;
                const scope = document.getElementById('exportScope').value;
                
                const extension = format === 'csv' ? 'csv' : 'json';
                const filename = `cards-export-${scope}-${new Date().toISOString().slice(0,10)}.${extension}`;
                
                const blob = new Blob([preview], { type: format === 'csv' ? 'text/csv' : 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.click();
                
                URL.revokeObjectURL(url);
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–≥—Ä—É–∑–∫–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞
            showServerLoadModal() {
                document.getElementById('serverLoadModal').classList.add('active');
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞
            async loadFromServer() {
                const url = document.getElementById('serverUrl').value;
                const mode = document.getElementById('serverLoadMode').value;
                
                if (!url) {
                    alert('–í–≤–µ–¥–∏—Ç–µ URL –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏!');
                    return;
                }
                
                const statusDiv = document.getElementById('serverStatus');
                statusDiv.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞...';
                statusDiv.style.color = '#f39c12';
                
                try {
                    const response = await fetch(url);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    const serverCards = data.cards || data;
                    
                    // –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ä–µ–∂–∏–º –∑–∞–≥—Ä—É–∑–∫–∏
                    switch (mode) {
                        case 'merge':
                            Object.assign(cards, serverCards);
                            break;
                        case 'replace':
                            cards = serverCards;
                            break;
                    }
                    
                    this.saveCards();
                    this.populateFilters();
                    this.renderCardList();
                    
                    statusDiv.textContent = `–ó–∞–≥—Ä—É–∂–µ–Ω–æ! –ö–∞—Ä—Ç–æ—á–µ–∫: ${Object.keys(serverCards).length}`;
                    statusDiv.style.color = '#27ae60';
                    
                    setTimeout(() => {
                        document.getElementById('serverLoadModal').classList.remove('active');
                    }, 2000);
                    
                } catch (error) {
                    statusDiv.textContent = `–û—à–∏–±–∫–∞: ${error.message}`;
                    statusDiv.style.color = '#e74c3c';
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞:', error);
                }
            }
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫
            validateCards() {
                const validation = this.validateCardSet(cards);
                const resultsDiv = document.getElementById('validationResults');
                const listDiv = document.getElementById('validationList');
                
                listDiv.innerHTML = '';
                
                if (validation.errors.length === 0 && validation.warnings.length === 0) {
                    listDiv.innerHTML = '<div class="validation-item success">‚úì –í—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –≤–∞–ª–∏–¥–Ω—ã!</div>';
                } else {
                    validation.errors.forEach(error => {
                        const div = document.createElement('div');
                        div.className = 'validation-item error';
                        div.textContent = `‚úó –û—à–∏–±–∫–∞: ${error}`;
                        listDiv.appendChild(div);
                    });
                    
                    validation.warnings.forEach(warning => {
                        const div = document.createElement('div');
                        div.className = 'validation-item warning';
                        div.textContent = `‚ö† –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: ${warning}`;
                        listDiv.appendChild(div);
                    });
                }
                
                resultsDiv.style.display = 'block';
            }
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞–±–æ—Ä–∞ –∫–∞—Ä—Ç–æ—á–µ–∫
            validateCardSet(cardSet) {
                const errors = [];
                const warnings = [];
                const ids = new Set();
                
                Object.keys(cardSet).forEach(id => {
                    const card = cardSet[id];
                    
                    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å ID
                    if (!id) {
                        errors.push(`–ü—É—Å—Ç–æ–π ID —É –∫–∞—Ä—Ç–æ—á–∫–∏`);
                        return;
                    }
                    
                    if (ids.has(id)) {
                        errors.push(`–î—É–±–ª–∏—Ä—É—é—â–∏–π—Å—è ID: ${id}`);
                    }
                    ids.add(id);
                    
                    if (!/^[A-Z0-9-]+$/.test(id)) {
                        warnings.push(`–ù–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç ID: ${id}`);
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
                    if (!card.text) {
                        errors.push(`–ö–∞—Ä—Ç–æ—á–∫–∞ ${id}: –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ç–µ–∫—Å—Ç`);
                    }
                    
                    if (!card.type) {
                        errors.push(`–ö–∞—Ä—Ç–æ—á–∫–∞ ${id}: –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ç–∏–ø`);
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Å—ã–ª–∫–∏ –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                    if (card.category && !cardSet[card.category]) {
                        warnings.push(`–ö–∞—Ä—Ç–æ—á–∫–∞ ${id}: –∫–∞—Ç–µ–≥–æ—Ä–∏—è "${card.category}" –Ω–µ –Ω–∞–π–¥–µ–Ω–∞`);
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å allowedObjects
                    if (card.metadata?.allowedObjects) {
                        card.metadata.allowedObjects.forEach(objId => {
                            if (!cardSet[objId]) {
                                warnings.push(`–ö–∞—Ä—Ç–æ—á–∫–∞ ${id}: –æ–±—ä–µ–∫—Ç "${objId}" –Ω–µ –Ω–∞–π–¥–µ–Ω`);
                            }
                        });
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å forms
                    if (card.forms) {
                        const validForms = ['accusative', 'genitive', 'dative', 'instrumental', 'prepositional', 'with', 'in', 'on'];
                        Object.keys(card.forms).forEach(form => {
                            if (!validForms.includes(form)) {
                                warnings.push(`–ö–∞—Ä—Ç–æ—á–∫–∞ ${id}: –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ñ–æ—Ä–º–∞ —Å–ª–æ–≤–∞: ${form}`);
                            }
                        });
                    }
                });
                
                return { errors, warnings };
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', () => {
            window.cardEditor = new CardEditor();
        });
    </script>
</body>
</html>