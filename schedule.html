<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ö–æ–º-–ö–æ–º: –†–∞—Å–ø–æ—Ä—è–¥–æ–∫ –¥–Ω—è</title>
  <style>
    /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Arial Rounded MT Bold', 'Arial', sans-serif;
    }

    body {
      padding: 20px;
      background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
      min-height: 100vh;
      font-size: var(--base-font-size, 16px);
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    h1, h2, h3 {
      text-align: center;
      margin-bottom: 20px;
      color: #1565c0;
    }

    h1 { font-size: calc(1.5rem * var(--font-scale, 1)); }
    h2 { font-size: calc(1.25rem * var(--font-scale, 1)); }
    h3 { font-size: calc(1.1rem * var(--font-scale, 1)); }

    /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
    .tabs-container {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      margin-bottom: 20px;
      border-bottom: 2px solid #e0e0e0;
      padding-bottom: 10px;
    }

    .tab-btn {
      padding: 10px 20px;
      background: #f8f9fa;
      border: none;
      border-radius: 8px 8px 0 0;
      cursor: pointer;
      font-size: 0.9rem;
      transition: all 0.3s;
      color: #555;
      font-weight: bold;
    }

    .tab-btn:hover {
      background: #e9ecef;
    }

    .tab-btn.active {
      background: #2196f3;
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .tab-content {
      display: none;
      animation: fadeIn 0.3s;
    }

    .tab-content.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* –í—ã–±–æ—Ä –¥–Ω—è –Ω–µ–¥–µ–ª–∏ */
    .day-selector {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      overflow-x: auto;
      padding: 10px 0;
    }

    .day-btn {
      padding: 10px 20px;
      background: #f8f9fa;
      border: 2px solid #ddd;
      border-radius: 8px;
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.3s;
      font-weight: bold;
      min-width: 120px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .day-btn.active {
      background: #2196f3;
      color: white;
      border-color: #2196f3;
      transform: scale(1.05);
    }

    .day-btn:hover:not(.active) {
      background: #e3f2fd;
      transform: translateY(-2px);
    }

    .day-emoji {
      font-size: 1.5rem;
      margin-bottom: 5px;
    }

    /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–Ω—è */
    .day-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .stat-card {
      background: white;
      border-radius: 10px;
      padding: 15px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .stat-icon {
      font-size: 2rem;
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #e3f2fd;
      border-radius: 50%;
    }

    .stat-info {
      flex: 1;
    }

    .stat-value {
      font-size: 1.5rem;
      font-weight: bold;
      color: #1565c0;
    }

    .stat-label {
      font-size: 0.9rem;
      color: #666;
    }

    /* –ö–∞—Ä—Ç–æ—á–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è */
    .schedule-cards {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-bottom: 20px;
    }

    .schedule-card-item {
      background: white;
      border: 2px solid #e3f2fd;
      border-radius: 10px;
      padding: 15px;
      display: flex;
      align-items: center;
      gap: 15px;
      box-shadow: 0 3px 5px rgba(0,0,0,0.1);
      transition: all 0.3s;
      cursor: pointer;
    }

    .schedule-card-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      border-color: #2196f3;
    }

    .schedule-card-item.completed {
      background: #e8f5e9;
      border-color: #4caf50;
    }

    .schedule-card-item.missed {
      background: #ffebee;
      border-color: #f44336;
      opacity: 0.7;
    }

    .schedule-time {
      font-weight: bold;
      font-size: 1.1rem;
      min-width: 80px;
      color: #1565c0;
      background: #f5f9ff;
      padding: 8px 12px;
      border-radius: 8px;
      text-align: center;
    }

    .schedule-emoji {
      font-size: 2rem;
      min-width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f0f8ff;
      border-radius: 50%;
      transition: transform 0.3s;
    }

    .schedule-card-item:hover .schedule-emoji {
      transform: scale(1.1);
    }

    .schedule-info {
      flex: 1;
    }

    .schedule-activity {
      font-size: 1.1rem;
      font-weight: 500;
      margin-bottom: 5px;
    }

    .schedule-duration {
      font-size: 0.9rem;
      color: #666;
    }

    .schedule-status {
      display: flex;
      gap: 10px;
    }

    .status-btn {
      width: 40px;
      height: 40px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      transition: all 0.3s;
    }

    .status-done {
      background: #4caf50;
      color: white;
    }

    .status-done:hover {
      background: #388e3c;
    }

    .status-missed {
      background: #f44336;
      color: white;
    }

    .status-missed:hover {
      background: #d32f2f;
    }

    .status-undone {
      background: #ff9800;
      color: white;
    }

    .status-undone:hover {
      background: #f57c00;
    }

    /* –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
    .control-panel {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    .control-btn {
      padding: 12px 24px;
      background: #2196f3;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: bold;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .control-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    .control-btn.add {
      background: #4caf50;
    }

    .control-btn.add:hover {
      background: #388e3c;
    }

    .control-btn.edit {
      background: #ff9800;
    }

    .control-btn.edit:hover {
      background: #f57c00;
    }

    .control-btn.speak {
      background: #9c27b0;
    }

    .control-btn.speak:hover {
      background: #7b1fa2;
    }

    .control-btn.save {
      background: #2196f3;
    }

    .control-btn.save:hover {
      background: #1976d2;
    }

    .control-btn.cancel {
      background: #f44336;
    }

    .control-btn.cancel:hover {
      background: #d32f2f;
    }

    /* –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è */
    .schedule-edit-mode .schedule-card-item {
      background: #f9f9f9;
      border-style: dashed;
      cursor: move;
    }

    .schedule-edit-actions {
      display: flex;
      gap: 5px;
      opacity: 1;
    }

    .schedule-edit-actions button {
      background: none;
      border: none;
      font-size: 1.2rem;
      cursor: pointer;
      padding: 5px;
      border-radius: 5px;
      transition: all 0.3s;
    }

    .schedule-edit-actions button:hover {
      background: #f0f0f0;
      transform: scale(1.1);
    }

    .schedule-edit-actions button:nth-child(1) { color: #2196f3; }
    .schedule-edit-actions button:nth-child(2) { color: #9c27b0; }
    .schedule-edit-actions button:nth-child(3) { color: #f44336; }

    /* –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ */
    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: #7f8c8d;
      background: #f9f9f9;
      border-radius: 10px;
      border: 2px dashed #ddd;
    }

    .empty-state h3 {
      margin-bottom: 10px;
      color: #1565c0;
    }

    .empty-state p {
      margin-bottom: 20px;
    }

    /* –§–æ—Ä–º—ã */
    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: #1565c0;
      font-weight: bold;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 1rem;
      transition: border-color 0.3s;
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #2196f3;
    }

    .time-input-group {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .time-input-group input {
      width: 80px;
      text-align: center;
    }

    .duration-input {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .duration-value {
      min-width: 40px;
      text-align: center;
      font-weight: bold;
      color: #2196f3;
    }

    /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ */
    .settings-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .settings-card {
      background: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
      transition: transform 0.3s;
    }

    .settings-card:hover {
      transform: translateY(-5px);
    }

    .settings-card h3 {
      color: #1565c0;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #f0f0f0;
    }

    .save-btn {
      background: #4caf50;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: bold;
      transition: background 0.3s;
      width: 100%;
      margin-top: 10px;
    }

    .save-btn:hover {
      background: #388e3c;
    }

    /* –ü–æ–ª–∑—É–Ω–∫–∏ */
    .slider-container {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
    }

    .slider-value {
      min-width: 40px;
      text-align: center;
      font-weight: bold;
      color: #2196f3;
    }

    input[type="range"] {
      flex: 1;
      height: 8px;
      border-radius: 4px;
      background: #e0e0e0;
      outline: none;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #2196f3;
      cursor: pointer;
    }

    /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      display: none;
    }

    .modal {
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      max-width: 500px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .pin-input {
      font-size: 24px;
      text-align: center;
      letter-spacing: 8px;
      padding: 10px;
      width: 100%;
      margin: 20px 0;
      border: 2px solid #2196f3;
      border-radius: 8px;
    }

    .pin-buttons {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
    }

    .pin-btn {
      padding: 15px;
      font-size: 1.2rem;
      border: 2px solid #2196f3;
      background: white;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .pin-btn:hover {
      background: #e3f2fd;
    }

    .modal-buttons {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .modal-btn {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s;
    }

    .modal-btn.confirm {
      background: #4caf50;
      color: white;
    }

    .modal-btn.confirm:hover {
      background: #388e3c;
    }

    .modal-btn.cancel {
      background: #f44336;
      color: white;
    }

    .modal-btn.cancel:hover {
      background: #d32f2f;
    }

    /* –≠–º–æ–¥–∑–∏-–ø–∏–∫–µ—Ä */
    .emoji-picker {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 5px;
      max-height: 300px;
      overflow-y: auto;
      padding: 10px;
      background: #f8f9fa;
      border-radius: 8px;
      margin-top: 10px;
    }

    .emoji-option {
      font-size: 1.8rem;
      cursor: pointer;
      text-align: center;
      padding: 10px;
      border-radius: 5px;
      transition: background 0.3s;
    }

    .emoji-option:hover {
      background: #e3f2fd;
      transform: scale(1.1);
    }

    /* –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ */
    .sortable-ghost {
      opacity: 0.4;
      background: #f0f8ff;
    }

    .sortable-chosen {
      box-shadow: 0 5px 15px rgba(33, 150, 243, 0.3);
    }

    /* –ü—Ä–æ–≥—Ä–µ—Å—Å */
    .progress-container {
      margin: 20px 0;
      background: #f0f0f0;
      border-radius: 10px;
      overflow: hidden;
      height: 20px;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #4caf50, #8bc34a);
      transition: width 0.5s ease-in-out;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 0.8rem;
      font-weight: bold;
    }

    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
    @media (max-width: 768px) {
      .day-selector {
        flex-wrap: nowrap;
        overflow-x: auto;
        padding-bottom: 5px;
      }

      .day-btn {
        min-width: 100px;
        padding: 8px 12px;
        font-size: 0.9rem;
      }

      .schedule-card-item {
        flex-direction: column;
        text-align: center;
        gap: 10px;
      }

      .schedule-time {
        min-width: auto;
      }

      .schedule-status {
        justify-content: center;
      }

      .control-panel {
        flex-direction: column;
        align-items: stretch;
      }

      .control-btn {
        width: 100%;
        justify-content: center;
      }

      .settings-grid {
        grid-template-columns: 1fr;
      }

      .time-input-group {
        flex-direction: column;
        align-items: stretch;
      }

      .time-input-group input {
        width: 100%;
      }
    }

    /* –ò–∫–æ–Ω–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è */
    .status-indicator {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      margin-right: 10px;
    }

    .status-done-indicator {
      background: #4caf50;
    }

    .status-missed-indicator {
      background: #f44336;
    }

    .status-pending-indicator {
      background: #ff9800;
    }

    /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: white;
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      z-index: 1000;
      animation: slideIn 0.3s ease-out;
      border-left: 4px solid #4caf50;
    }

    .notification.error {
      border-left-color: #f44336;
    }

    .notification.warning {
      border-left-color: #ff9800;
    }

    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    /* –ó–≤—É–∫–æ–≤–æ–µ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ */
    .sound-controls {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
    }

    .sound-toggle {
      width: 40px;
      height: 20px;
      background: #ddd;
      border-radius: 10px;
      cursor: pointer;
      position: relative;
      transition: background 0.3s;
    }

    .sound-toggle.active {
      background: #4caf50;
    }

    .sound-toggle::after {
      content: '';
      position: absolute;
      width: 16px;
      height: 16px;
      background: white;
      border-radius: 50%;
      top: 2px;
      left: 2px;
      transition: transform 0.3s;
    }

    .sound-toggle.active::after {
      transform: translateX(20px);
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìÖ –†–∞—Å–ø–æ—Ä—è–¥–æ–∫ –¥–Ω—è</h1>
    
    <div class="tabs-container">
      <button class="tab-btn active" data-tab="schedule">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</button>
      <button class="tab-btn" data-tab="statistics">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
      <button class="tab-btn" data-tab="settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è -->
    <div id="schedule" class="tab-content active">
      <div class="day-selector" id="daySelector">
        <button class="day-btn active" data-day="monday">
          <span class="day-emoji">üìÖ</span> –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫
        </button>
        <button class="day-btn" data-day="tuesday">
          <span class="day-emoji">üìÖ</span> –í—Ç–æ—Ä–Ω–∏–∫
        </button>
        <button class="day-btn" data-day="wednesday">
          <span class="day-emoji">üìÖ</span> –°—Ä–µ–¥–∞
        </button>
        <button class="day-btn" data-day="thursday">
          <span class="day-emoji">üìÖ</span> –ß–µ—Ç–≤–µ—Ä–≥
        </button>
        <button class="day-btn" data-day="friday">
          <span class="day-emoji">üìÖ</span> –ü—è—Ç–Ω–∏—Ü–∞
        </button>
        <button class="day-btn" data-day="saturday">
          <span class="day-emoji">üéâ</span> –°—É–±–±–æ—Ç–∞
        </button>
        <button class="day-btn" data-day="sunday">
          <span class="day-emoji">‚òÄÔ∏è</span> –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ
        </button>
      </div>

      <div class="day-stats" id="dayStats">
        <div class="stat-card">
          <div class="stat-icon">‚è±Ô∏è</div>
          <div class="stat-info">
            <div class="stat-value" id="totalActivities">0</div>
            <div class="stat-label">–í—Å–µ–≥–æ –∑–∞–Ω—è—Ç–∏–π</div>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">‚úÖ</div>
          <div class="stat-info">
            <div class="stat-value" id="completedActivities">0</div>
            <div class="stat-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">‚è∞</div>
          <div class="stat-info">
            <div class="stat-value" id="totalDuration">0—á</div>
            <div class="stat-label">–û–±—â–µ–µ –≤—Ä–µ–º—è</div>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">üìä</div>
          <div class="stat-info">
            <div class="stat-value" id="completionRate">0%</div>
            <div class="stat-label">–ü—Ä–æ–≥—Ä–µ—Å—Å</div>
          </div>
        </div>
      </div>

      <div class="progress-container">
        <div class="progress-bar" id="progressBar" style="width: 0%">0%</div>
      </div>

      <div class="control-panel">
        <button class="control-btn add" id="addActivityBtn">
          ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∑–∞–Ω—è—Ç–∏–µ
        </button>
        <button class="control-btn edit" id="editScheduleBtn">
          ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
        </button>
        <button class="control-btn speak" id="speakScheduleBtn">
          üîä –û–∑–≤—É—á–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
        </button>
        <button class="control-btn" id="saveScheduleBtn" style="display: none;">
          üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
        </button>
        <button class="control-btn cancel" id="cancelEditBtn" style="display: none;">
          ‚ùå –û—Ç–º–µ–Ω–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
        </button>
      </div>

      <div class="schedule-cards" id="scheduleCards"></div>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
    <div id="statistics" class="tab-content">
      <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ–¥–µ–ª–∏</h2>
      
      <div class="day-stats">
        <div class="stat-card">
          <div class="stat-icon">üìÖ</div>
          <div class="stat-info">
            <div class="stat-value" id="weekTotal">0</div>
            <div class="stat-label">–í—Å–µ–≥–æ –∑–∞–Ω—è—Ç–∏–π –∑–∞ –Ω–µ–¥–µ–ª—é</div>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">‚úÖ</div>
          <div class="stat-info">
            <div class="stat-value" id="weekCompleted">0</div>
            <div class="stat-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞–Ω—è—Ç–∏–π</div>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">‚≠ê</div>
          <div class="stat-info">
            <div class="stat-value" id="productivityScore">0</div>
            <div class="stat-label">–ë–∞–ª–ª—ã –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</div>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">üî•</div>
          <div class="stat-info">
            <div class="stat-value" id="streakDays">0</div>
            <div class="stat-label">–î–Ω–µ–π –ø–æ–¥—Ä—è–¥</div>
          </div>
        </div>
      </div>

      <h3 style="margin-top: 30px;">üìà –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –¥–Ω—è–º</h3>
      <div id="weekChart" style="height: 300px; background: #f9f9f9; border-radius: 10px; padding: 20px; margin-top: 20px;">
        <div style="display: flex; align-items: flex-end; height: 250px; gap: 10px; justify-content: center;">
          <!-- –ì—Ä–∞—Ñ–∏–∫ –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è JavaScript -->
        </div>
      </div>

      <h3 style="margin-top: 30px;">üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h3>
      <div id="achievements" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
        <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è JavaScript -->
      </div>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
    <div id="settings" class="tab-content">
      <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å–ø–æ—Ä—è–¥–∫–∞</h2>
      
      <div class="settings-grid">
        <div class="settings-card">
          <h3>üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h3>
          <div class="form-group">
            <label>–¢–µ–∫—É—â–∏–π PIN-–∫–æ–¥</label>
            <input type="password" id="currentPin" maxlength="4" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—É—â–∏–π PIN">
          </div>
          <div class="form-group">
            <label>–ù–æ–≤—ã–π PIN-–∫–æ–¥ (4 —Ü–∏—Ñ—Ä—ã)</label>
            <input type="password" id="newPin" maxlength="4" placeholder="–ù–æ–≤—ã–π PIN">
          </div>
          <div class="form-group">
            <label>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ PIN-–∫–æ–¥</label>
            <input type="password" id="confirmPin" maxlength="4" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ PIN">
          </div>
          <button class="save-btn" id="changePinBtn">–°–º–µ–Ω–∏—Ç—å PIN</button>
        </div>

        <div class="settings-card">
          <h3>üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</h3>
          <div class="form-group">
            <label>
              <input type="checkbox" id="enableReminders" checked>
              –í–∫–ª—é—á–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
            </label>
          </div>
          <div class="form-group">
            <label>–ò–Ω—Ç–µ—Ä–≤–∞–ª –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π (–º–∏–Ω—É—Ç)</label>
            <div class="slider-container">
              <span>5</span>
              <input type="range" id="reminderInterval" min="5" max="60" step="5" value="15">
              <span>60</span>
              <div class="slider-value" id="reminderValue">15</div>
            </div>
          </div>
          <div class="form-group">
            <label>–ó–≤—É–∫ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π</label>
            <select id="reminderSound">
              <option value="bell">üîî –ö–æ–ª–æ–∫–æ–ª—å—á–∏–∫</option>
              <option value="chime">üéµ –ú–µ–ª–æ–¥–∏—è</option>
              <option value="beep">üì¢ –°–∏–≥–Ω–∞–ª</option>
            </select>
          </div>
        </div>

        <div class="settings-card">
          <h3>üéß –û–∑–≤—É—á–∏–≤–∞–Ω–∏–µ</h3>
          <div class="form-group">
            <label>–°–∫–æ—Ä–æ—Å—Ç—å —Ä–µ—á–∏</label>
            <div class="slider-container">
              <span>–ú–µ–¥–ª–µ–Ω–Ω–µ–µ</span>
              <input type="range" id="speechRate" min="0.5" max="2" step="0.1" value="1.0">
              <span>–ë—ã—Å—Ç—Ä–µ–µ</span>
              <div class="slider-value" id="speechRateValue">1.0</div>
            </div>
          </div>
          <div class="form-group">
            <label>–ì–æ–ª–æ—Å –¥–ª—è –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è</label>
            <select id="voiceSelect">
              <option value="">–°–∏—Å—Ç–µ–º–Ω—ã–π –≥–æ–ª–æ—Å</option>
            </select>
          </div>
          <div class="sound-controls">
            <span>–ó–≤—É–∫:</span>
            <div class="sound-toggle" id="soundToggle"></div>
            <span>–í–∫–ª—é—á–µ–Ω–æ</span>
          </div>
        </div>

        <div class="settings-card">
          <h3>üé® –í–Ω–µ—à–Ω–∏–π –≤–∏–¥</h3>
          <div class="form-group">
            <label>–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞</label>
            <div class="slider-container">
              <span>–ú–µ–Ω—å—à–µ</span>
              <input type="range" id="fontSizeSlider" min="70" max="150" step="5" value="100">
              <span>–ë–æ–ª—å—à–µ</span>
              <div class="slider-value" id="fontSizeValue">100%</div>
            </div>
          </div>
        </div>

        <div class="settings-card">
          <h3>üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏</h3>
          <div style="display: flex; flex-direction: column; gap: 10px;">
            <button class="control-btn" id="exportDataBtn">
              üì§ –≠–∫—Å–ø–æ—Ä—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
            </button>
            <button class="control-btn" id="importDataBtn">
              üì• –ò–º–ø–æ—Ä—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
            </button>
            <input type="file" id="importFile" style="display: none;" accept=".json">
            <button class="control-btn" id="resetDataBtn" style="background: #f44336;">
              üîÑ –°–±—Ä–æ—Å–∏—Ç—å –∫ –Ω–∞—á–∞–ª—å–Ω—ã–º
            </button>
          </div>
        </div>

        <div class="settings-card">
          <h3>‚ÑπÔ∏è –û –ø—Ä–æ–≥—Ä–∞–º–º–µ</h3>
          <div style="margin-top: 15px;">
            <p><strong>–í–µ—Ä—Å–∏—è:</strong> 2.1.0</p>
            <p><strong>–û–±–Ω–æ–≤–ª–µ–Ω–æ:</strong> <span id="lastUpdated">-</span></p>
            <p><strong>–ê–≤—Ç–æ—Ä:</strong> –ü–∞–≤–µ–ª –ö–æ–ø—á–µ–Ω–æ–≤</p>
            <p><strong>–õ–∏—Ü–µ–Ω–∑–∏—è:</strong> Apache 2.0</p>
            <p style="margin-top: 15px;">
              <button class="control-btn" onclick="window.open('../index.html', '_blank')" style="width: 100%;">
                üîÑ –ü–µ—Ä–µ–π—Ç–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–æ—Ä
              </button>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–Ω—è—Ç–∏—è -->
  <div id="activityModal" class="modal-overlay">
    <div class="modal">
      <h3 id="modalTitle">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–Ω—è—Ç–∏–µ</h3>
      
      <div class="form-group">
        <label>–í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞</label>
        <div class="time-input-group">
          <input type="text" id="activityHour" maxlength="2" placeholder="–ß–ß" value="08">
          <span>:</span>
          <input type="text" id="activityMinute" maxlength="2" placeholder="–ú–ú" value="00">
        </div>
      </div>

      <div class="form-group">
        <label>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–∏–Ω—É—Ç)</label>
        <div class="duration-input">
          <span>5</span>
          <input type="range" id="activityDuration" min="5" max="180" step="5" value="30">
          <span>180</span>
          <div class="slider-value" id="durationValue">30</div>
        </div>
      </div>

      <div class="form-group">
        <label>–≠–º–æ–¥–∑–∏</label>
        <div style="display: flex; align-items: center; gap: 10px;">
          <div id="selectedEmoji" style="font-size: 2rem; width: 60px; text-align: center;">üìÖ</div>
          <button class="control-btn" id="chooseEmojiBtn">–í—ã–±—Ä–∞—Ç—å —ç–º–æ–¥–∑–∏</button>
        </div>
      </div>

      <div class="form-group">
        <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏—è</label>
        <input type="text" id="activityName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ó–∞–≤—Ç—Ä–∞–∫, –£—Ä–æ–∫–∏, –ü—Ä–æ–≥—É–ª–∫–∞">
      </div>

      <div class="form-group">
        <label>–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
        <textarea id="activityDescription" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏..."></textarea>
      </div>

      <div class="modal-buttons">
        <button class="modal-btn confirm" id="saveActivityBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button class="modal-btn cancel" id="cancelActivityBtn">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ PIN -->
  <div id="pinModal" class="modal-overlay">
    <div class="modal">
      <h3>–í–≤–µ–¥–∏—Ç–µ PIN-–∫–æ–¥</h3>
      <input type="password" id="pinInput" class="pin-input" maxlength="4" readonly>
      <div class="pin-buttons">
        <button class="pin-btn" data-pin="1">1</button>
        <button class="pin-btn" data-pin="2">2</button>
        <button class="pin-btn" data-pin="3">3</button>
        <button class="pin-btn" data-pin="4">4</button>
        <button class="pin-btn" data-pin="5">5</button>
        <button class="pin-btn" data-pin="6">6</button>
        <button class="pin-btn" data-pin="7">7</button>
        <button class="pin-btn" data-pin="8">8</button>
        <button class="pin-btn" data-pin="9">9</button>
        <button class="pin-btn" data-pin="0">0</button>
        <button class="pin-btn" data-pin="clear">–°—Ç–µ—Ä–µ—Ç—å</button>
        <button class="pin-btn" data-pin="enter">–í–≤–æ–¥</button>
      </div>
      <div class="modal-buttons" style="margin-top: 20px;">
        <button class="modal-btn cancel" id="cancelPinBtn">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —ç–º–æ–¥–∑–∏ -->
  <div id="emojiModal" class="modal-overlay">
    <div class="modal">
      <h3>–í—ã–±–µ—Ä–∏—Ç–µ —ç–º–æ–¥–∑–∏</h3>
      <div class="emoji-picker" id="emojiPicker"></div>
      <div class="modal-buttons" style="margin-top: 20px;">
        <button class="modal-btn cancel" id="cancelEmojiBtn">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>

  <script>
    const DEFAULT_PIN = "0000";
    const DEFAULT_SCHEDULE = {
      monday: [
        { time: "08:00", activity: "–ü–æ–¥—ä–µ–º", emoji: "‚è∞", duration: 30, description: "–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ!", completed: false },
        { time: "08:30", activity: "–ó–∞—Ä—è–¥–∫–∞", emoji: "üèÉ", duration: 15, description: "–ë–æ–¥—Ä–æ—Å—Ç—å –Ω–∞ –≤–µ—Å—å –¥–µ–Ω—å", completed: false },
        { time: "08:45", activity: "–£–º—ã–≤–∞–Ω–∏–µ", emoji: "üöø", duration: 15, description: "", completed: false },
        { time: "09:00", activity: "–ó–∞–≤—Ç—Ä–∞–∫", emoji: "üç≥", duration: 30, description: "–ü–æ–ª–µ–∑–Ω—ã–π –∑–∞–≤—Ç—Ä–∞–∫", completed: false },
        { time: "09:30", activity: "–£—Ä–æ–∫–∏", emoji: "üìö", duration: 90, description: "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞, —Ä—É—Å—Å–∫–∏–π", completed: false },
        { time: "11:00", activity: "–ü–µ—Ä–µ—Ä—ã–≤", emoji: "‚òï", duration: 15, description: "", completed: false },
        { time: "11:15", activity: "–ß—Ç–µ–Ω–∏–µ", emoji: "üìñ", duration: 45, description: "–ö–Ω–∏–≥–∞ –ø–æ –≤—ã–±–æ—Ä—É", completed: false },
        { time: "12:00", activity: "–ü—Ä–æ–≥—É–ª–∫–∞", emoji: "üå≥", duration: 60, description: "–°–≤–µ–∂–∏–π –≤–æ–∑–¥—É—Ö", completed: false },
        { time: "13:00", activity: "–û–±–µ–¥", emoji: "üç≤", duration: 45, description: "", completed: false },
        { time: "13:45", activity: "–û—Ç–¥—ã—Ö", emoji: "üò¥", duration: 30, description: "–¢–∏—Ö–∏–π —á–∞—Å", completed: false },
        { time: "14:15", activity: "–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ", emoji: "üé®", duration: 60, description: "–†–∏—Å–æ–≤–∞–Ω–∏–µ, –ª–µ–ø–∫–∞", completed: false },
        { time: "15:15", activity: "–ò–≥—Ä—ã", emoji: "üéÆ", duration: 45, description: "–ù–∞—Å—Ç–æ–ª—å–Ω—ã–µ –∏–≥—Ä—ã", completed: false },
        { time: "16:00", activity: "–ü–æ–ª–¥–Ω–∏–∫", emoji: "üçé", duration: 20, description: "–§—Ä—É–∫—Ç—ã", completed: false },
        { time: "16:20", activity: "–ú—É–∑—ã–∫–∞", emoji: "üéµ", duration: 40, description: "–°–ª—É—à–∞–µ–º –º—É–∑—ã–∫—É", completed: false },
        { time: "17:00", activity: "–í–µ—á–µ—Ä–Ω—è—è –ø—Ä–æ–≥—É–ª–∫–∞", emoji: "üåá", duration: 45, description: "", completed: false },
        { time: "18:00", activity: "–£–∂–∏–Ω", emoji: "üçΩÔ∏è", duration: 45, description: "–°–µ–º–µ–π–Ω—ã–π —É–∂–∏–Ω", completed: false },
        { time: "19:00", activity: "–°–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è", emoji: "üì∫", duration: 60, description: "–ú—É–ª—å—Ç—Ñ–∏–ª—å–º—ã", completed: false },
        { time: "20:00", activity: "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ —Å–Ω—É", emoji: "üõÅ", duration: 30, description: "–í–∞–Ω–Ω–∞, —á—Ç–µ–Ω–∏–µ", completed: false },
        { time: "20:30", activity: "–°–æ–Ω", emoji: "üåô", duration: 600, description: "–°–ø–æ–∫–æ–π–Ω–æ–π –Ω–æ—á–∏", completed: false }
      ],
      tuesday: [
        { time: "08:00", activity: "–ü–æ–¥—ä–µ–º", emoji: "‚è∞", duration: 30, description: "", completed: false },
        { time: "08:30", activity: "–ó–∞—Ä—è–¥–∫–∞", emoji: "ü§∏", duration: 15, description: "", completed: false },
        { time: "08:45", activity: "–ó–∞–≤—Ç—Ä–∞–∫", emoji: "ü•û", duration: 30, description: "", completed: false },
        { time: "09:15", activity: "–¢–µ—Ä–∞–ø–∏—è", emoji: "üß©", duration: 60, description: "–†–∞–∑–≤–∏–≤–∞—é—â–∏–µ –∑–∞–Ω—è—Ç–∏—è", completed: false },
        { time: "10:15", activity: "–ü—Ä–æ–≥—É–ª–∫–∞", emoji: "üå§Ô∏è", duration: 45, description: "", completed: false },
        { time: "11:00", activity: "–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ", emoji: "‚úèÔ∏è", duration: 60, description: "–†–∏—Å–æ–≤–∞–Ω–∏–µ", completed: false },
        { time: "12:00", activity: "–û–±–µ–¥", emoji: "üçù", duration: 45, description: "", completed: false },
        { time: "12:45", activity: "–ß—Ç–µ–Ω–∏–µ", emoji: "üìö", duration: 45, description: "", completed: false },
        { time: "13:30", activity: "–û—Ç–¥—ã—Ö", emoji: "üò¥", duration: 60, description: "", completed: false },
        { time: "14:30", activity: "–ò–≥—Ä—ã", emoji: "üé≤", duration: 90, description: "–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä", completed: false },
        { time: "16:00", activity: "–ü–æ–ª–¥–Ω–∏–∫", emoji: "üçå", duration: 20, description: "", completed: false },
        { time: "16:20", activity: "–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è", emoji: "üéπ", duration: 40, description: "", completed: false },
        { time: "17:00", activity: "–ü—Ä–æ–≥—É–ª–∫–∞", emoji: "üö∂", duration: 60, description: "", completed: false },
        { time: "18:00", activity: "–£–∂–∏–Ω", emoji: "ü•ó", duration: 45, description: "", completed: false },
        { time: "19:00", activity: "–°–µ–º–µ–π–Ω–æ–µ –≤—Ä–µ–º—è", emoji: "üë®‚Äçüë©‚Äçüëß‚Äçüë¶", duration: 60, description: "", completed: false },
        { time: "20:00", activity: "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ —Å–Ω—É", emoji: "ü¶∑", duration: 30, description: "", completed: false },
        { time: "20:30", activity: "–°–æ–Ω", emoji: "üò¥", duration: 600, description: "", completed: false }
      ],
      wednesday: [
        { time: "08:00", activity: "–ü–æ–¥—ä–µ–º", emoji: "‚è∞", duration: 30, description: "", completed: false },
        { time: "08:30", activity: "–£—Ç—Ä–µ–Ω–Ω—è—è –≥–∏–º–Ω–∞—Å—Ç–∏–∫–∞", emoji: "üßò", duration: 20, description: "", completed: false },
        { time: "08:50", activity: "–ó–∞–≤—Ç—Ä–∞–∫", emoji: "üçØ", duration: 40, description: "", completed: false },
        { time: "09:30", activity: "–†–∞–∑–≤–∏–≤–∞—é—â–∏–µ –∏–≥—Ä—ã", emoji: "üß†", duration: 60, description: "–ü–∞–∑–ª—ã, –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∏", completed: false },
        { time: "10:30", activity: "–ú—É–∑—ã–∫–∞", emoji: "üéµ", duration: 45, description: "–ü–µ–Ω–∏–µ, —Ä–∏—Ç–º–∏–∫–∞", completed: false },
        { time: "11:15", activity: "–ü—Ä–æ–≥—É–ª–∫–∞", emoji: "üå≥", duration: 90, description: "–ü–∞—Ä–∫, –∏–≥—Ä–æ–≤–∞—è –ø–ª–æ—â–∞–¥–∫–∞", completed: false },
        { time: "13:00", activity: "–û–±–µ–¥", emoji: "üçõ", duration: 45, description: "", completed: false },
        { time: "13:45", activity: "–î–Ω–µ–≤–Ω–æ–π —Å–æ–Ω", emoji: "üò¥", duration: 90, description: "", completed: false },
        { time: "15:15", activity: "–ß—Ç–µ–Ω–∏–µ", emoji: "üìñ", duration: 45, description: "–°–∫–∞–∑–∫–∏", completed: false },
        { time: "16:00", activity: "–¢–≤–æ—Ä—á–µ—Å–∫–∞—è –º–∞—Å—Ç–µ—Ä—Å–∫–∞—è", emoji: "üé≠", duration: 60, description: "–ê–ø–ø–ª–∏–∫–∞—Ü–∏–∏, –ø–æ–¥–µ–ª–∫–∏", completed: false },
        { time: "17:00", activity: "–ò–≥—Ä—ã –Ω–∞ —Å–≤–µ–∂–µ–º –≤–æ–∑–¥—É—Ö–µ", emoji: "‚öΩ", duration: 60, description: "", completed: false },
        { time: "18:00", activity: "–£–∂–∏–Ω", emoji: "üçΩÔ∏è", duration: 45, description: "", completed: false },
        { time: "19:00", activity: "–°–ø–æ–∫–æ–π–Ω—ã–µ –∏–≥—Ä—ã", emoji: "üé¥", duration: 60, description: "", completed: false },
        { time: "20:00", activity: "–í–µ—á–µ—Ä–Ω–∏–π —Ä–∏—Ç—É–∞–ª", emoji: "üõÄ", duration: 30, description: "", completed: false },
        { time: "20:30", activity: "–°–æ–Ω", emoji: "üåô", duration: 600, description: "", completed: false }
      ],
      thursday: [
        { time: "08:00", activity: "–ü–æ–¥—ä–µ–º", emoji: "‚è∞", duration: 30, description: "", completed: false },
        { time: "08:30", activity: "–ë–æ–¥—Ä—è—â–∞—è –∑–∞—Ä—è–¥–∫–∞", emoji: "üí™", duration: 20, description: "", completed: false },
        { time: "08:50", activity: "–ó–∞–≤—Ç—Ä–∞–∫", emoji: "ü•ê", duration: 40, description: "", completed: false },
        { time: "09:30", activity: "–û–±—É—á–µ–Ω–∏–µ", emoji: "üìù", duration: 90, description: "–ü–∏—Å—å–º–æ, —á—Ç–µ–Ω–∏–µ", completed: false },
        { time: "11:00", activity: "–ü–µ—Ä–µ—Ä—ã–≤", emoji: "üçµ", duration: 15, description: "", completed: false },
        { time: "11:15", activity: "–õ–æ–≥–æ–ø–µ–¥–∏—á–µ—Å–∫–∏–µ –∑–∞–Ω—è—Ç–∏—è", emoji: "üó£Ô∏è", duration: 45, description: "", completed: false },
        { time: "12:00", activity: "–ü—Ä–æ–≥—É–ª–∫–∞", emoji: "üö¥", duration: 60, description: "", completed: false },
        { time: "13:00", activity: "–û–±–µ–¥", emoji: "üç≤", duration: 45, description: "", completed: false },
        { time: "13:45", activity: "–û—Ç–¥—ã—Ö", emoji: "üò¥", duration: 45, description: "", completed: false },
        { time: "14:30", activity: "–ö–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞–Ω–∏–µ", emoji: "üß±", duration: 60, description: "–õ–µ–≥–æ, –∫—É–±–∏–∫–∏", completed: false },
        { time: "15:30", activity: "–†–∏—Å–æ–≤–∞–Ω–∏–µ", emoji: "üñçÔ∏è", duration: 45, description: "", completed: false },
        { time: "16:15", activity: "–ü–æ–ª–¥–Ω–∏–∫", emoji: "üçì", duration: 30, description: "", completed: false },
        { time: "16:45", activity: "–°–≤–æ–±–æ–¥–Ω–∞—è –∏–≥—Ä–∞", emoji: "üé™", duration: 75, description: "", completed: false },
        { time: "18:00", activity: "–£–∂–∏–Ω", emoji: "ü•ò", duration: 45, description: "", completed: false },
        { time: "19:00", activity: "–ß—Ç–µ–Ω–∏–µ –∫–Ω–∏–≥", emoji: "üìö", duration: 60, description: "", completed: false },
        { time: "20:00", activity: "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ —Å–Ω—É", emoji: "‚ú®", duration: 30, description: "", completed: false },
        { time: "20:30", activity: "–°–æ–Ω", emoji: "üò¥", duration: 600, description: "", completed: false }
      ],
      friday: [
        { time: "08:00", activity: "–ü–æ–¥—ä–µ–º", emoji: "üåÖ", duration: 30, description: "", completed: false },
        { time: "08:30", activity: "–í–µ—Å–µ–ª–∞—è –∑–∞—Ä—è–¥–∫–∞", emoji: "ü§∏‚Äç‚ôÇÔ∏è", duration: 20, description: "", completed: false },
        { time: "08:50", activity: "–ó–∞–≤—Ç—Ä–∞–∫", emoji: "üçå", duration: 40, description: "", completed: false },
        { time: "09:30", activity: "–£—á–µ–±–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è", emoji: "üßÆ", duration: 90, description: "–°—á–µ—Ç, –ª–æ–≥–∏–∫–∞", completed: false },
        { time: "11:00", activity: "–¢–≤–æ—Ä—á–µ—Å–∫–∞—è –ø–∞—É–∑–∞", emoji: "üé≠", duration: 30, description: "", completed: false },
        { time: "11:30", activity: "–ü—Ä–æ–≥—É–ª–∫–∞", emoji: "üå≤", duration: 90, description: "–õ–µ—Å, –ø–∞—Ä–∫", completed: false },
        { time: "13:00", activity: "–û–±–µ–¥", emoji: "üçï", duration: 45, description: "", completed: false },
        { time: "13:45", activity: "–¢–∏—Ö–∏–π —á–∞—Å", emoji: "üò¥", duration: 60, description: "", completed: false },
        { time: "14:45", activity: "–ù–∞—Å—Ç–æ–ª—å–Ω—ã–µ –∏–≥—Ä—ã", emoji: "üé≤", duration: 75, description: "", completed: false },
        { time: "16:00", activity: "–†–∞–∑–≤–∏—Ç–∏–µ —Ä–µ—á–∏", emoji: "üí¨", duration: 45, description: "", completed: false },
        { time: "16:45", activity: "–ü–æ–ª–¥–Ω–∏–∫", emoji: "üç∞", duration: 30, description: "", completed: false },
        { time: "17:15", activity: "–ê–∫—Ç–∏–≤–Ω—ã–µ –∏–≥—Ä—ã", emoji: "ü§∏‚Äç‚ôÄÔ∏è", duration: 45, description: "", completed: false },
        { time: "18:00", activity: "–£–∂–∏–Ω", emoji: "üçΩÔ∏è", duration: 45, description: "", completed: false },
        { time: "19:00", activity: "–ü—Ä–æ—Å–º–æ—Ç—Ä —Ñ–∏–ª—å–º–∞", emoji: "üé¨", duration: 90, description: "–°–µ–º–µ–π–Ω—ã–π –∫–∏–Ω–æ—Å–µ–∞–Ω—Å", completed: false },
        { time: "20:30", activity: "–í–µ—á–µ—Ä–Ω–∏–π —Ä–∏—Ç—É–∞–ª", emoji: "üõå", duration: 30, description: "", completed: false },
        { time: "21:00", activity: "–°–æ–Ω", emoji: "üåô", duration: 600, description: "", completed: false }
      ],
      saturday: [
        { time: "09:00", activity: "–ü–æ–¥—ä–µ–º", emoji: "üåû", duration: 30, description: "–ú–æ–∂–Ω–æ –ø–æ—Å–ø–∞—Ç—å –ø–æ–¥–æ–ª—å—à–µ", completed: false },
        { time: "09:30", activity: "–ó–∞–≤—Ç—Ä–∞–∫", emoji: "ü•û", duration: 45, description: "–í–∫—É—Å–Ω—ã–π –∑–∞–≤—Ç—Ä–∞–∫", completed: false },
        { time: "10:15", activity: "–°–µ–º–µ–π–Ω–æ–µ –≤—Ä–µ–º—è", emoji: "üë®‚Äçüë©‚Äçüëß‚Äçüë¶", duration: 120, description: "–û–±—â–µ–Ω–∏–µ, –∏–≥—Ä—ã", completed: false },
        { time: "12:15", activity: "–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ", emoji: "üé®", duration: 60, description: "–°–æ–≤–º–µ—Å—Ç–Ω–æ–µ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ", completed: false },
        { time: "13:15", activity: "–û–±–µ–¥", emoji: "üçï", duration: 60, description: "–õ—é–±–∏–º—ã–µ –±–ª—é–¥–∞", completed: false },
        { time: "14:15", activity: "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è", emoji: "üé™", duration: 180, description: "–ü–∞—Ä–∫, –∫–∏–Ω–æ, –≥–æ—Å—Ç–∏", completed: false },
        { time: "17:15", activity: "–°–ø–æ–∫–æ–π–Ω—ã–µ –∏–≥—Ä—ã", emoji: "üé¥", duration: 45, description: "", completed: false },
        { time: "18:00", activity: "–£–∂–∏–Ω", emoji: "üçΩÔ∏è", duration: 60, description: "", completed: false },
        { time: "19:00", activity: "–í–µ—á–µ—Ä–Ω–∏–π –æ—Ç–¥—ã—Ö", emoji: "üì∫", duration: 90, description: "", completed: false },
        { time: "20:30", activity: "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ —Å–Ω—É", emoji: "üßñ", duration: 30, description: "", completed: false },
        { time: "21:00", activity: "–°–æ–Ω", emoji: "üò¥", duration: 600, description: "", completed: false }
      ],
      sunday: [
        { time: "09:00", activity: "–ü–æ–¥—ä–µ–º", emoji: "üåÖ", duration: 30, description: "", completed: false },
        { time: "09:30", activity: "–ó–∞–≤—Ç—Ä–∞–∫", emoji: "üç≥", duration: 45, description: "", completed: false },
        { time: "10:15", activity: "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –Ω–µ–¥–µ–ª–µ", emoji: "üìù", duration: 60, description: "–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ", completed: false },
        { time: "11:15", activity: "–°–ø–æ–∫–æ–π–Ω—ã–π –æ—Ç–¥—ã—Ö", emoji: "‚òï", duration: 120, description: "–ß—Ç–µ–Ω–∏–µ, –Ω–∞—Å—Ç–æ–ª—å–Ω—ã–µ –∏–≥—Ä—ã", completed: false },
        { time: "13:15", activity: "–û–±–µ–¥", emoji: "üç≤", duration: 60, description: "", completed: false },
        { time: "14:15", activity: "–ü—Ä–æ–≥—É–ª–∫–∞ –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ", emoji: "üö∂", duration: 90, description: "", completed: false },
        { time: "15:45", activity: "–î–æ–º–∞—à–Ω–∏–µ –¥–µ–ª–∞", emoji: "üßπ", duration: 60, description: "–£–±–æ—Ä–∫–∞ –∫–æ–º–Ω–∞—Ç—ã", completed: false },
        { time: "16:45", activity: "–•–æ–±–±–∏", emoji: "üéØ", duration: 75, description: "–õ—é–±–∏–º–æ–µ –∑–∞–Ω—è—Ç–∏–µ", completed: false },
        { time: "18:00", activity: "–£–∂–∏–Ω", emoji: "üçΩÔ∏è", duration: 45, description: "", completed: false },
        { time: "19:00", activity: "–ü–æ–¥–≤–µ–¥–µ–Ω–∏–µ –∏—Ç–æ–≥–æ–≤ –Ω–µ–¥–µ–ª–∏", emoji: "üìä", duration: 60, description: "", completed: false },
        { time: "20:00", activity: "–†–∞—Å—Å–ª–∞–±–ª—è—é—â–∏–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã", emoji: "üõÅ", duration: 30, description: "", completed: false },
        { time: "20:30", activity: "–°–æ–Ω", emoji: "üåô", duration: 600, description: "", completed: false }
      ]
    };

    let currentPin = localStorage.getItem('communicator_pin') || DEFAULT_PIN;
    let currentDay = 'monday';
    let schedule = loadSchedule();
    let isEditing = false;
    let currentActivityEdit = null;
    let currentEmoji = 'üìÖ';
    let speechRate = parseFloat(localStorage.getItem('speech_rate') || '1.0');
    let fontSizeScale = parseFloat(localStorage.getItem('font_size_scale') || '1.0');
    let voices = [];
    let selectedVoice = null;
    let pinAction = null;

    class ScheduleApp {
      constructor() {
        this.init();
      }

      init() {
        this.applySettings();
        this.bindEvents();
        this.renderSchedule();
        this.updateStats();
        this.initVoices();
        this.updateLastUpdated();
      }

      applySettings() {
        document.documentElement.style.setProperty('--font-scale', fontSizeScale);
        document.documentElement.style.setProperty('--base-font-size', (16 * fontSizeScale) + 'px');
      }

      bindEvents() {
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–∞–±–æ–≤
        document.querySelectorAll('.tab-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            const tabId = btn.getAttribute('data-tab');
            
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            btn.classList.add('active');
            document.getElementById(tabId).classList.add('active');
            
            if (tabId === 'statistics') {
              this.updateStatistics();
            }
          });
        });

        // –í—ã–±–æ—Ä –¥–Ω—è –Ω–µ–¥–µ–ª–∏
        document.querySelectorAll('.day-btn').forEach(btn => {
          btn.addEventListener('click', (e) => {
            document.querySelectorAll('.day-btn').forEach(b => b.classList.remove('active'));
            e.currentTarget.classList.add('active');
            currentDay = e.currentTarget.getAttribute('data-day');
            this.renderSchedule();
            this.updateStats();
          });
        });

        // –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        document.getElementById('addActivityBtn').addEventListener('click', () => {
          this.showActivityModal();
        });

        document.getElementById('editScheduleBtn').addEventListener('click', () => {
          this.showPinModal('edit');
        });

        document.getElementById('speakScheduleBtn').addEventListener('click', () => {
          this.speakSchedule();
        });

        document.getElementById('saveScheduleBtn').addEventListener('click', () => {
          this.saveSchedule();
          this.hideEditControls();
        });

        document.getElementById('cancelEditBtn').addEventListener('click', () => {
          this.hideEditControls();
        });

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ PIN
        document.getElementById('changePinBtn').addEventListener('click', () => {
          this.changePin();
        });

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞
        document.getElementById('fontSizeSlider').addEventListener('input', (e) => {
          const value = e.target.value;
          document.getElementById('fontSizeValue').textContent = value + '%';
          fontSizeScale = value / 100;
          localStorage.setItem('font_size_scale', fontSizeScale);
          this.applySettings();
        });

        document.getElementById('speechRate').addEventListener('input', (e) => {
          const value = e.target.value;
          document.getElementById('speechRateValue').textContent = value;
          speechRate = parseFloat(value);
          localStorage.setItem('speech_rate', speechRate);
        });

        document.getElementById('reminderInterval').addEventListener('input', (e) => {
          document.getElementById('reminderValue').textContent = e.target.value;
        });

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏
        document.getElementById('exportDataBtn').addEventListener('click', () => {
          this.exportData();
        });

        document.getElementById('importDataBtn').addEventListener('click', () => {
          document.getElementById('importFile').click();
        });

        document.getElementById('importFile').addEventListener('change', (e) => {
          this.importData(e);
        });

        document.getElementById('resetDataBtn').addEventListener('click', () => {
          this.resetData();
        });

        // –ó–≤—É–∫–æ–≤–æ–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å
        document.getElementById('soundToggle').addEventListener('click', () => {
          const toggle = document.getElementById('soundToggle');
          toggle.classList.toggle('active');
          localStorage.setItem('schedule_sound_enabled', toggle.classList.contains('active'));
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–≤—É–∫–æ–≤–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è
        const soundEnabled = localStorage.getItem('schedule_sound_enabled') !== 'false';
        document.getElementById('soundToggle').classList.toggle('active', soundEnabled);

        // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–Ω—è—Ç–∏—è
        document.getElementById('saveActivityBtn').addEventListener('click', () => {
          this.saveActivity();
        });

        document.getElementById('cancelActivityBtn').addEventListener('click', () => {
          this.hideActivityModal();
        });

        document.getElementById('chooseEmojiBtn').addEventListener('click', () => {
          this.showEmojiPicker();
        });

        // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏
        document.getElementById('activityHour').addEventListener('input', (e) => {
          let value = e.target.value.replace(/\D/g, '');
          if (value > 23) value = 23;
          if (value.length > 2) value = value.slice(0, 2);
          e.target.value = value;
        });

        document.getElementById('activityMinute').addEventListener('input', (e) => {
          let value = e.target.value.replace(/\D/g, '');
          if (value > 59) value = 59;
          if (value.length > 2) value = value.slice(0, 2);
          e.target.value = value;
        });

        document.getElementById('activityDuration').addEventListener('input', (e) => {
          document.getElementById('durationValue').textContent = e.target.value;
        });

        // –≠–º–æ–¥–∑–∏ –ø–∏–∫–µ—Ä
        this.initEmojiPicker();
      }

      initVoices() {
        // –ó–∞–≥—Ä—É–∑–∫–∞ –≥–æ–ª–æ—Å–æ–≤ –¥–ª—è —Ä–µ—á–∏
        if ('speechSynthesis' in window) {
          voices = speechSynthesis.getVoices();
          const voiceSelect = document.getElementById('voiceSelect');
          voiceSelect.innerHTML = '<option value="">–°–∏—Å—Ç–µ–º–Ω—ã–π –≥–æ–ª–æ—Å</option>';
          
          voices.forEach(voice => {
            if (voice.lang.includes('ru') || voice.lang.includes('RU')) {
              const option = document.createElement('option');
              option.value = voice.name;
              option.textContent = `${voice.name} (${voice.lang})`;
              voiceSelect.appendChild(option);
            }
          });
          
          const savedVoice = localStorage.getItem('selected_voice');
          if (savedVoice) {
            voiceSelect.value = savedVoice;
            selectedVoice = voices.find(v => v.name === savedVoice);
          }
          
          voiceSelect.addEventListener('change', (e) => {
            selectedVoice = voices.find(v => v.name === e.target.value);
            localStorage.setItem('selected_voice', e.target.value || '');
          });
        }
      }

      initEmojiPicker() {
        const emojiPicker = document.getElementById('emojiPicker');
        const emojis = [
          '‚è∞', '‚òÄÔ∏è', 'üåô', 'üò¥', 'üõèÔ∏è', 'üöø', 'ü™•', 'üß¥', 'üöΩ', 'üßª',
          'üç≥', 'üçé', 'ü•™', 'üç≤', 'üçΩÔ∏è', 'ü•§', 'üç™', 'üç¶', 'üçï', 'üçî',
          'üìö', '‚úèÔ∏è', 'üìù', 'üé®', 'üß©', 'üéÆ', '‚öΩ', 'üèÄ', 'üéæ', 'üèä',
          'üö¥', 'üßò', 'üéµ', 'üéπ', 'üé∏', 'üé§', 'üì∫', 'üé¨', 'üé™', 'üé≠',
          'üå≥', 'üö∂', 'üèÉ', 'üöó', 'üöå', '‚úàÔ∏è', 'üè†', 'üè´', 'üè•', 'üõí',
          'üõçÔ∏è', 'üí∞', 'üíä', '‚ù§Ô∏è', 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶', 'üë´', 'üê∂', 'üê±', 'üê∞', 'üê¢',
          'üì±', 'üíª', '‚åö', 'üì∑', 'üéÅ', 'üéÇ', 'üéÑ', 'üéâ', 'üèÜ', '‚≠ê',
          '‚úÖ', '‚ùå', '‚ö†Ô∏è', 'üîî', 'üìÖ', 'üìä', 'üí°', 'üîã', 'üìû', '‚úâÔ∏è',
          'üß∏', 'ü§ñ', 'üëæ', 'üéà', 'üé®', 'üéØ', 'ü•Ö', 'üé≥', 'üé£', 'üéø',
          'üèñÔ∏è', '‚õ∞Ô∏è', 'üåä', 'üåà', '‚òÅÔ∏è', '‚ùÑÔ∏è', 'üî•', 'üíß', 'üå±', 'üå∏',
          'üåª', 'üå∫', 'üêù', 'ü¶ã', 'üêû', 'ü¶â', 'üêß', 'ü¶Å', 'üêØ', 'ü¶ä'
        ];
        
        emojis.forEach(emoji => {
          const emojiOption = document.createElement('div');
          emojiOption.className = 'emoji-option';
          emojiOption.textContent = emoji;
          emojiOption.addEventListener('click', () => {
            this.selectEmoji(emoji);
          });
          emojiPicker.appendChild(emojiOption);
        });
      }

      renderSchedule() {
        const container = document.getElementById('scheduleCards');
        const daySchedule = schedule[currentDay] || [];
        
        container.innerHTML = '';
        
        if (daySchedule.length === 0) {
          container.innerHTML = `
            <div class="empty-state">
              <h3>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–µ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–æ</h3>
              <p>–ù–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–Ω—è—Ç–∏–π.</p>
              <button class="control-btn add" onclick="app.showActivityModal()" style="margin-top: 20px;">
                ‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤–æ–µ –∑–∞–Ω—è—Ç–∏–µ
              </button>
            </div>
          `;
          return;
        }

        // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏
        daySchedule.sort((a, b) => this.timeToMinutes(a.time) - this.timeToMinutes(b.time));

        daySchedule.forEach((activity, index) => {
          const activityCard = document.createElement('div');
          activityCard.className = `schedule-card-item ${activity.completed ? 'completed' : ''}`;
          activityCard.dataset.index = index;
          
          const startTime = this.timeToMinutes(activity.time);
          const endTime = startTime + activity.duration;
          const endTimeStr = this.minutesToTime(endTime);
          
          activityCard.innerHTML = `
            <div class="schedule-time">${activity.time}</div>
            <div class="schedule-emoji">${activity.emoji}</div>
            <div class="schedule-info">
              <div class="schedule-activity">${activity.activity}</div>
              <div class="schedule-duration">
                ${activity.duration} –º–∏–Ω. (–¥–æ ${endTimeStr})
                ${activity.description ? ` ‚Ä¢ ${activity.description}` : ''}
              </div>
            </div>
            <div class="schedule-status">
              ${isEditing ? `
                <div class="schedule-edit-actions">
                  <button onclick="app.editActivity(${index})" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úèÔ∏è</button>
                  <button onclick="app.showEmojiPickerForActivity(${index})" title="–°–º–µ–Ω–∏—Ç—å —ç–º–æ–¥–∑–∏">üòÄ</button>
                  <button onclick="app.deleteActivity(${index})" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</button>
                </div>
              ` : `
                <button class="status-btn status-done" onclick="app.toggleActivityStatus(${index}, 'done')" 
                  title="–û—Ç–º–µ—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º">${activity.completed ? '‚Ü©Ô∏è' : '‚úì'}</button>
                <button class="status-btn status-missed" onclick="app.toggleActivityStatus(${index}, 'missed')" 
                  title="–û—Ç–º–µ—Ç–∏—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º">‚úï</button>
              `}
            </div>
          `;
          
          if (!isEditing) {
            activityCard.addEventListener('click', (e) => {
              if (!e.target.closest('.schedule-status')) {
                this.speakActivity(activity);
              }
            });
          }
          
          container.appendChild(activityCard);
        });

        // –î–µ–ª–∞–µ–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å–æ—Ä—Ç–∏—Ä—É–µ–º—ã–º –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        if (isEditing && daySchedule.length > 0) {
          this.makeSortable();
        }
      }

      makeSortable() {
        const container = document.getElementById('scheduleCards');
        let draggedItem = null;
        
        container.querySelectorAll('.schedule-card-item').forEach(item => {
          item.setAttribute('draggable', 'true');
          
          item.addEventListener('dragstart', (e) => {
            draggedItem = item;
            setTimeout(() => item.classList.add('sortable-ghost'), 0);
          });
          
          item.addEventListener('dragend', (e) => {
            setTimeout(() => {
              item.classList.remove('sortable-ghost');
              draggedItem = null;
            }, 0);
          });
          
          item.addEventListener('dragover', (e) => {
            e.preventDefault();
            const afterElement = this.getDragAfterElement(container, e.clientY);
            if (afterElement == null) {
              container.appendChild(draggedItem);
            } else {
              container.insertBefore(draggedItem, afterElement);
            }
          });
        });
      }

      getDragAfterElement(container, y) {
        const draggableElements = [...container.querySelectorAll('.schedule-card-item:not(.sortable-ghost)')];
        
        return draggableElements.reduce((closest, child) => {
          const box = child.getBoundingClientRect();
          const offset = y - box.top - box.height / 2;
          
          if (offset < 0 && offset > closest.offset) {
            return { offset: offset, element: child };
          } else {
            return closest;
          }
        }, { offset: Number.NEGATIVE_INFINITY }).element;
      }

      updateStats() {
        const daySchedule = schedule[currentDay] || [];
        const total = daySchedule.length;
        const completed = daySchedule.filter(a => a.completed).length;
        const totalDuration = daySchedule.reduce((sum, a) => sum + a.duration, 0);
        const completionRate = total > 0 ? Math.round((completed / total) * 100) : 0;
        
        document.getElementById('totalActivities').textContent = total;
        document.getElementById('completedActivities').textContent = completed;
        document.getElementById('totalDuration').textContent = `${Math.floor(totalDuration / 60)}—á ${totalDuration % 60}–º`;
        document.getElementById('completionRate').textContent = `${completionRate}%`;
        
        // –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä
        const progressBar = document.getElementById('progressBar');
        progressBar.style.width = `${completionRate}%`;
        progressBar.textContent = `${completionRate}%`;
      }

      updateStatistics() {
        // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –Ω–µ–¥–µ–ª—é
        let weekTotal = 0;
        let weekCompleted = 0;
        let productivityScore = 0;
        
        Object.values(schedule).forEach(day => {
          weekTotal += day.length;
          weekCompleted += day.filter(a => a.completed).length;
          productivityScore += day.filter(a => a.completed).length * 10;
        });
        
        document.getElementById('weekTotal').textContent = weekTotal;
        document.getElementById('weekCompleted').textContent = weekCompleted;
        document.getElementById('productivityScore').textContent = productivityScore;
        
        // –î–Ω–∏ –ø–æ–¥—Ä—è–¥ (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
        const streakDays = Object.keys(schedule).filter(day => 
          schedule[day].some(a => a.completed)
        ).length;
        document.getElementById('streakDays').textContent = streakDays;
        
        // –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
        this.renderWeekChart();
        
        // –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
        this.renderAchievements();
      }

      renderWeekChart() {
        const chartContainer = document.getElementById('weekChart').querySelector('div');
        chartContainer.innerHTML = '';
        
        const days = ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'];
        const dayKeys = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
        
        dayKeys.forEach((dayKey, index) => {
          const daySchedule = schedule[dayKey] || [];
          const total = daySchedule.length;
          const completed = daySchedule.filter(a => a.completed).length;
          const height = total > 0 ? (completed / total) * 200 : 0;
          
          const barContainer = document.createElement('div');
          barContainer.style.display = 'flex';
          barContainer.style.flexDirection = 'column';
          barContainer.style.alignItems = 'center';
          barContainer.style.gap = '5px';
          
          const bar = document.createElement('div');
          bar.style.width = '40px';
          bar.style.height = `${height}px`;
          bar.style.background = height > 0 ? 'linear-gradient(to top, #4caf50, #8bc34a)' : '#e0e0e0';
          bar.style.borderRadius = '5px 5px 0 0';
          bar.style.transition = 'height 0.5s ease-in-out';
          
          const label = document.createElement('div');
          label.textContent = days[index];
          label.style.fontSize = '0.9rem';
          label.style.color = '#666';
          
          const value = document.createElement('div');
          value.textContent = total > 0 ? `${Math.round((completed / total) * 100)}%` : '-';
          value.style.fontSize = '0.8rem';
          value.style.fontWeight = 'bold';
          value.style.color = '#1565c0';
          
          barContainer.appendChild(value);
          barContainer.appendChild(bar);
          barContainer.appendChild(label);
          chartContainer.appendChild(barContainer);
        });
      }

      renderAchievements() {
        const achievementsContainer = document.getElementById('achievements');
        achievementsContainer.innerHTML = '';
        
        const achievements = [
          { id: 'early_bird', title: '–†–∞–Ω–Ω—è—è –ø—Ç–∞—à–∫–∞', icon: 'üåÖ', desc: '–ü–æ–¥—ä–µ–º –¥–æ 7 —É—Ç—Ä–∞', earned: false },
          { id: 'perfect_day', title: '–ò–¥–µ–∞–ª—å–Ω—ã–π –¥–µ–Ω—å', icon: '‚≠ê', desc: '–í—Å–µ –∑–∞–Ω—è—Ç–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã', earned: false },
          { id: 'week_complete', title: '–ù–µ–¥–µ–ª—è –ø–æ–±–µ–¥', icon: 'üèÜ', desc: '7 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥', earned: false },
          { id: 'productivity', title: '–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å', icon: 'üöÄ', desc: '50+ –±–∞–ª–ª–æ–≤', earned: false }
        ];
        
        achievements.forEach(achievement => {
          const achievementCard = document.createElement('div');
          achievementCard.className = 'stat-card';
          achievementCard.style.opacity = achievement.earned ? '1' : '0.5';
          
          achievementCard.innerHTML = `
            <div class="stat-icon">${achievement.icon}</div>
            <div class="stat-info">
              <div style="font-weight: bold; margin-bottom: 5px;">${achievement.title}</div>
              <div style="font-size: 0.9rem; color: #666;">${achievement.desc}</div>
            </div>
          `;
          
          achievementsContainer.appendChild(achievementCard);
        });
      }

      showActivityModal(activityIndex = null) {
        const modal = document.getElementById('activityModal');
        const title = document.getElementById('modalTitle');
        
        if (activityIndex !== null) {
          // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∑–∞–Ω—è—Ç–∏—è
          currentActivityEdit = activityIndex;
          const activity = schedule[currentDay][activityIndex];
          
          title.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–Ω—è—Ç–∏–µ';
          document.getElementById('activityHour').value = activity.time.split(':')[0];
          document.getElementById('activityMinute').value = activity.time.split(':')[1];
          document.getElementById('activityDuration').value = activity.duration;
          document.getElementById('durationValue').textContent = activity.duration;
          document.getElementById('activityName').value = activity.activity;
          document.getElementById('activityDescription').value = activity.description;
          document.getElementById('selectedEmoji').textContent = activity.emoji;
          currentEmoji = activity.emoji;
        } else {
          // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∑–∞–Ω—è—Ç–∏—è
          currentActivityEdit = null;
          title.textContent = '–î–æ–±–∞–≤–∏—Ç—å –∑–∞–Ω—è—Ç–∏–µ';
          document.getElementById('activityHour').value = '08';
          document.getElementById('activityMinute').value = '00';
          document.getElementById('activityDuration').value = 30;
          document.getElementById('durationValue').textContent = '30';
          document.getElementById('activityName').value = '';
          document.getElementById('activityDescription').value = '';
          document.getElementById('selectedEmoji').textContent = 'üìÖ';
          currentEmoji = 'üìÖ';
        }
        
        modal.style.display = 'flex';
      }

      hideActivityModal() {
        document.getElementById('activityModal').style.display = 'none';
        currentActivityEdit = null;
      }

      saveActivity() {
        const hour = document.getElementById('activityHour').value.padStart(2, '0');
        const minute = document.getElementById('activityMinute').value.padStart(2, '0');
        const time = `${hour}:${minute}`;
        const duration = parseInt(document.getElementById('activityDuration').value);
        const name = document.getElementById('activityName').value.trim();
        const description = document.getElementById('activityDescription').value.trim();
        
        if (!name) {
          this.showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏—è', 'error');
          return;
        }
        
        if (!schedule[currentDay]) {
          schedule[currentDay] = [];
        }
        
        const activity = {
          time: time,
          activity: name,
          emoji: currentEmoji,
          duration: duration,
          description: description,
          completed: false
        };
        
        if (currentActivityEdit !== null) {
          // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ
          schedule[currentDay][currentActivityEdit] = activity;
        } else {
          // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ
          schedule[currentDay].push(activity);
        }
        
        // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏
        schedule[currentDay].sort((a, b) => this.timeToMinutes(a.time) - this.timeToMinutes(b.time));
        
        this.saveScheduleToStorage();
        this.renderSchedule();
        this.updateStats();
        this.hideActivityModal();
        
        this.showNotification(
          currentActivityEdit !== null ? '–ó–∞–Ω—è—Ç–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ' : '–ó–∞–Ω—è—Ç–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ'
        );
      }

      editActivity(index) {
        this.showActivityModal(index);
      }

      deleteActivity(index) {
        if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ –∑–∞–Ω—è—Ç–∏–µ?')) {
          schedule[currentDay].splice(index, 1);
          this.saveScheduleToStorage();
          this.renderSchedule();
          this.updateStats();
          this.showNotification('–ó–∞–Ω—è—Ç–∏–µ —É–¥–∞–ª–µ–Ω–æ');
        }
      }

      toggleActivityStatus(index, status) {
        const activity = schedule[currentDay][index];
        
        switch(status) {
          case 'done':
            activity.completed = !activity.completed;
            break;
          case 'missed':
            activity.completed = false;
            break;
        }
        
        this.saveScheduleToStorage();
        this.renderSchedule();
        this.updateStats();
        
        // –û–∑–≤—É—á–∏–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
        const statusText = activity.completed ? '–í—ã–ø–æ–ª–Ω–µ–Ω–æ' : '–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ';
        this.speakText(`${activity.activity} - ${statusText}`);
      }

      showEditControls() {
        isEditing = true;
        document.getElementById('editScheduleBtn').style.display = 'none';
        document.getElementById('addActivityBtn').style.display = 'none';
        document.getElementById('speakScheduleBtn').style.display = 'none';
        document.getElementById('saveScheduleBtn').style.display = 'block';
        document.getElementById('cancelEditBtn').style.display = 'block';
        document.getElementById('scheduleCards').classList.add('schedule-edit-mode');
        this.renderSchedule();
      }

      hideEditControls() {
        isEditing = false;
        document.getElementById('editScheduleBtn').style.display = 'block';
        document.getElementById('addActivityBtn').style.display = 'block';
        document.getElementById('speakScheduleBtn').style.display = 'block';
        document.getElementById('saveScheduleBtn').style.display = 'none';
        document.getElementById('cancelEditBtn').style.display = 'none';
        document.getElementById('scheduleCards').classList.remove('schedule-edit-mode');
        this.renderSchedule();
      }

      showEmojiPicker() {
        document.getElementById('emojiModal').style.display = 'flex';
      }

      showEmojiPickerForActivity(index) {
        currentActivityEdit = index;
        this.showEmojiPicker();
      }

      selectEmoji(emoji) {
        currentEmoji = emoji;
        document.getElementById('selectedEmoji').textContent = emoji;
        document.getElementById('emojiModal').style.display = 'none';
        
        // –ï—Å–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –∑–∞–Ω—è—Ç–∏–µ, –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ
        if (currentActivityEdit !== null && typeof currentActivityEdit === 'number') {
          schedule[currentDay][currentActivityEdit].emoji = emoji;
          this.renderSchedule();
        }
      }

      showPinModal(action) {
        pinAction = action;
        document.getElementById('pinInput').value = '';
        document.getElementById('pinModal').style.display = 'flex';
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–Ω–æ–ø–æ–∫ PIN
        document.querySelectorAll('.pin-btn').forEach(btn => {
          btn.onclick = null;
          btn.addEventListener('click', () => {
            const value = btn.getAttribute('data-pin');
            const pinInput = document.getElementById('pinInput');
            
            if (value === 'clear') {
              pinInput.value = '';
            } else if (value === 'enter') {
              this.checkPin(pinInput.value);
            } else {
              if (pinInput.value.length < 4) {
                pinInput.value += value;
              }
            }
          });
        });
      }

      checkPin(enteredPin) {
        if (enteredPin === currentPin) {
          document.getElementById('pinModal').style.display = 'none';
          document.getElementById('pinInput').value = '';
          
          if (pinAction === 'edit') {
            this.showEditControls();
          }
        } else {
          this.showNotification('–ù–µ–≤–µ—Ä–Ω—ã–π PIN-–∫–æ–¥!', 'error');
          document.getElementById('pinInput').value = '';
        }
        pinAction = null;
      }

      changePin() {
        const currentPinInput = document.getElementById('currentPin').value;
        const newPin = document.getElementById('newPin').value;
        const confirmPin = document.getElementById('confirmPin').value;
        
        if (currentPinInput !== currentPin) {
          this.showNotification('–¢–µ–∫—É—â–∏–π PIN-–∫–æ–¥ –Ω–µ–≤–µ—Ä–µ–Ω', 'error');
          return;
        }
        
        if (newPin.length !== 4 || !/^\d+$/.test(newPin)) {
          this.showNotification('PIN –¥–æ–ª–∂–µ–Ω —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ 4 —Ü–∏—Ñ—Ä', 'error');
          return;
        }
        
        if (newPin !== confirmPin) {
          this.showNotification('PIN-–∫–æ–¥—ã –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç', 'error');
          return;
        }
        
        currentPin = newPin;
        localStorage.setItem('communicator_pin', currentPin);
        
        document.getElementById('currentPin').value = '';
        document.getElementById('newPin').value = '';
        document.getElementById('confirmPin').value = '';
        
        this.showNotification('PIN-–∫–æ–¥ —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω–µ–Ω');
        this.updateLastUpdated();
      }

      speakSchedule() {
        const daySchedule = schedule[currentDay] || [];
        
        if (daySchedule.length === 0) {
          this.speakText('–ù–∞ —Å–µ–≥–æ–¥–Ω—è –∑–∞–Ω—è—Ç–∏–π –Ω–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ');
          return;
        }
        
        let speech = `–†–∞—Å–ø–æ—Ä—è–¥–æ–∫ –Ω–∞ ${this.getDayName(currentDay)}: `;
        
        daySchedule.forEach((activity, index) => {
          speech += `${activity.time} - ${activity.activity}. `;
        });
        
        this.speakText(speech);
      }

      speakActivity(activity) {
        const status = activity.completed ? '–≤—ã–ø–æ–ª–Ω–µ–Ω–æ' : '–∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ';
        const speech = `${activity.time}, ${activity.activity}, –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å ${activity.duration} –º–∏–Ω—É—Ç, ${status}`;
        this.speakText(speech);
      }

      speakText(text) {
        if ('speechSynthesis' in window && document.getElementById('soundToggle').classList.contains('active')) {
          speechSynthesis.cancel();
          
          const utterance = new SpeechSynthesisUtterance(text);
          utterance.lang = 'ru-RU';
          utterance.rate = speechRate;
          utterance.pitch = 1.1;
          
          if (selectedVoice) {
            utterance.voice = selectedVoice;
          }
          
          utterance.onstart = () => {
            console.log('–ù–∞—á–∞–ª–æ –æ–∑–≤—É—á–∫–∏:', text);
          };
          
          utterance.onend = () => {
            console.log('–û–∫–æ–Ω—á–∞–Ω–∏–µ –æ–∑–≤—É—á–∫–∏');
          };
          
          utterance.onerror = (event) => {
            console.error('–û—à–∏–±–∫–∞ –æ–∑–≤—É—á–∫–∏:', event);
          };
          
          speechSynthesis.speak(utterance);
        }
      }

      exportData() {
        const data = {
          schedule: schedule,
          exportDate: new Date().toISOString(),
          version: '2.1.0'
        };
        
        const dataStr = JSON.stringify(data, null, 2);
        const dataBlob = new Blob([dataStr], {type: 'application/json'});
        const link = document.createElement('a');
        link.href = URL.createObjectURL(dataBlob);
        link.download = `schedule_${new Date().toISOString().slice(0,10)}.json`;
        link.click();
        
        this.showNotification('–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ');
      }

      importData(event) {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = (e) => {
          try {
            const importedData = JSON.parse(e.target.result);
            
            if (importedData.schedule) {
              if (confirm('–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ? –¢–µ–∫—É—â–µ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –±—É–¥–µ—Ç –∑–∞–º–µ–Ω–µ–Ω–æ.')) {
                schedule = importedData.schedule;
                this.saveScheduleToStorage();
                this.renderSchedule();
                this.updateStats();
                this.updateLastUpdated();
                this.showNotification('–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ');
              }
            } else {
              this.showNotification('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞', 'error');
            }
          } catch (error) {
            this.showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ: ' + error.message, 'error');
          }
        };
        reader.readAsText(file);
        event.target.value = '';
      }

      resetData() {
        if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤—Å—ë —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∫ –Ω–∞—á–∞–ª—å–Ω–æ–º—É? –í—Å–µ –≤–∞—à–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.')) {
          schedule = JSON.parse(JSON.stringify(DEFAULT_SCHEDULE));
          this.saveScheduleToStorage();
          this.renderSchedule();
          this.updateStats();
          this.updateLastUpdated();
          this.showNotification('–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å–±—Ä–æ—à–µ–Ω–æ –∫ –Ω–∞—á–∞–ª—å–Ω–æ–º—É');
        }
      }

      saveScheduleToStorage() {
        localStorage.setItem('childSchedule', JSON.stringify(schedule));
        this.updateLastUpdated();
      }

      updateLastUpdated() {
        const now = new Date();
        document.getElementById('lastUpdated').textContent = 
          now.toLocaleDateString('ru-RU') + ' ' + now.toLocaleTimeString('ru-RU').slice(0,5);
      }

      showNotification(message, type = 'success') {
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.textContent = message;
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
          notification.style.animation = 'slideIn 0.3s ease-out reverse';
          setTimeout(() => {
            if (notification.parentNode) {
              document.body.removeChild(notification);
            }
          }, 300);
        }, 3000);
      }

      // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
      timeToMinutes(time) {
        const [hours, minutes] = time.split(':').map(Number);
        return hours * 60 + minutes;
      }

      minutesToTime(minutes) {
        const hours = Math.floor(minutes / 60) % 24;
        const mins = minutes % 60;
        return `${hours.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}`;
      }

      getDayName(dayKey) {
        const names = {
          monday: '–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫',
          tuesday: '–≤—Ç–æ—Ä–Ω–∏–∫',
          wednesday: '—Å—Ä–µ–¥–∞',
          thursday: '—á–µ—Ç–≤–µ—Ä–≥',
          friday: '–ø—è—Ç–Ω–∏—Ü–∞',
          saturday: '—Å—É–±–±–æ—Ç–∞',
          sunday: '–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ'
        };
        return names[dayKey] || dayKey;
      }
    }

    function loadSchedule() {
      const saved = localStorage.getItem('childSchedule');
      return saved ? JSON.parse(saved) : JSON.parse(JSON.stringify(DEFAULT_SCHEDULE));
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    document.addEventListener('DOMContentLoaded', () => {
      window.app = new ScheduleApp();
      
      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ–ª–∑—É–Ω–∫–æ–≤
      document.getElementById('fontSizeSlider').value = fontSizeScale * 100;
      document.getElementById('fontSizeValue').textContent = (fontSizeScale * 100).toFixed(0) + '%';
      
      document.getElementById('speechRate').value = speechRate;
      document.getElementById('speechRateValue').textContent = speechRate;
      
      const reminderInterval = localStorage.getItem('reminder_interval') || 15;
      document.getElementById('reminderInterval').value = reminderInterval;
      document.getElementById('reminderValue').textContent = reminderInterval;
      
      // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
      document.getElementById('cancelPinBtn').addEventListener('click', () => {
        document.getElementById('pinModal').style.display = 'none';
        pinAction = null;
      });
      
      document.getElementById('cancelEmojiBtn').addEventListener('click', () => {
        document.getElementById('emojiModal').style.display = 'none';
      });
      
      // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
      document.querySelectorAll('.modal-overlay').forEach(modal => {
        modal.addEventListener('click', (e) => {
          if (e.target === modal) {
            modal.style.display = 'none';
            if (modal.id === 'pinModal') pinAction = null;
          }
        });
      });
      
      // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
      document.getElementById('reminderInterval').addEventListener('change', (e) => {
        localStorage.setItem('reminder_interval', e.target.value);
      });
      
      document.getElementById('enableReminders').addEventListener('change', (e) => {
        localStorage.setItem('reminders_enabled', e.target.checked);
      });
      
      document.getElementById('reminderSound').addEventListener('change', (e) => {
        localStorage.setItem('reminder_sound', e.target.value);
      });
      
      // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
      const remindersEnabled = localStorage.getItem('reminders_enabled') !== 'false';
      document.getElementById('enableReminders').checked = remindersEnabled;
      
      const reminderSound = localStorage.getItem('reminder_sound') || 'bell';
      document.getElementById('reminderSound').value = reminderSound;
      
      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
      if ('speechSynthesis' in window) {
        speechSynthesis.onvoiceschanged = () => {
          window.app.initVoices();
        };
      }
    });
  </script>
</body>
</html>